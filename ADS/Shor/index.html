
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../Particle%20Swarm%20Optimization/">
      
      
        <link rel="next" href="../SkipList/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.50">
    
    
      
        <title>Shor - My Docs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.a40c8224.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#shor" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="My Docs" class="md-header__button md-logo" aria-label="My Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            My Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Shor
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="blue"  aria-label="切换到暗色模式"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="切换到暗色模式" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="deep-purple" data-md-color-accent="purple"  aria-label="切换到亮色模式"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="切换到亮色模式" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/akonjac0/note" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    Ako's Note
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../about/" class="md-tabs__link">
        
  
    
  
  About

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../BPlusTree/" class="md-tabs__link">
          
  
  ADS

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../CO/computer%20organization%20and%20design/" class="md-tabs__link">
          
  
  CO

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../general%20physics/General%20Pyhsics%20II/" class="md-tabs__link">
          
  
  General physics

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../misc/CTF/" class="md-tabs__link">
          
  
  Misc

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../my%20past/MCU/51/" class="md-tabs__link">
          
  
  My past

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../probability/martingale%20and%20stopping%20times/" class="md-tabs__link">
          
  
  Probability

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../x86asm/ASM/" class="md-tabs__link">
          
  
  X86asm

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="My Docs" class="md-nav__button md-logo" aria-label="My Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    My Docs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/akonjac0/note" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    Ako's Note
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    ADS
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            ADS
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../BPlusTree/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BPlusTree
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Binomial%20Queue/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Binomial Queue
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Fibonacci%20Heap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fibonacci Heap
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Galois%20Field/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Galois Field
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../IFI/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IFI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Master%20Theorem/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Master Theorem
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Mersenne%20twister/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mersenne Twister
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Misra-Gries/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Misra-Gries
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../NPC%20and%20Approximation%20and%20Local%20Search/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NPC and Approximation and Local Search
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Particle%20Swarm%20Optimization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Particle Swarm Optimization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Shor
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Shor
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#shor_1" class="md-nav__link">
    <span class="md-ellipsis">
      Shor算法简介
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      量子傅里叶变换
    </span>
  </a>
  
    <nav class="md-nav" aria-label="量子傅里叶变换">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dft" class="md-nav__link">
    <span class="md-ellipsis">
      DFT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qft" class="md-nav__link">
    <span class="md-ellipsis">
      QFT
    </span>
  </a>
  
    <nav class="md-nav" aria-label="QFT">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qft_1" class="md-nav__link">
    <span class="md-ellipsis">
      QFT
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qft_2" class="md-nav__link">
    <span class="md-ellipsis">
      整理 QFT 得出量子电路易实现的形式
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      电路实现
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      模指
    </span>
  </a>
  
    <nav class="md-nav" aria-label="模指">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      量子加法器
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      量子模加器
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      量子可控模乘器
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      模指模块
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qpe" class="md-nav__link">
    <span class="md-ellipsis">
      量子相位估计 QPE
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#shor_2" class="md-nav__link">
    <span class="md-ellipsis">
      Shor 算法
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Shor 算法">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      约化素数因子分解
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fxaxmod-n" class="md-nav__link">
    <span class="md-ellipsis">
      求解 \(f(x)=a^x\mod N\) 的周期
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      电路实现
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../SkipList/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Skip List
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../WBLT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    WBLT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../amortized%20analysis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    amortized analysis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../binet%20cauchy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Binet-Cauchy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cardinality%20of%20sets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cardinality of sets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../closest%20pairs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    closest pairs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../computation%20problem/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    computation problem
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../convex/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    convex
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../error%20correction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    error correction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../external%20sorting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    external sorting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../game%20theory/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    组合游戏
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../group%20theory/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    group theory
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../linear%20programming/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    linear programming
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../miller%20rabin/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    miller rabin
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pairing%20heap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pairing Heap
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../parallel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    parallel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pollard%20rho/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pollard rho
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../randomized/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    randomized
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../red%20black%20tree/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    red black tree
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../scapegoat%20tree/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    scapegoat
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../searching/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    searching
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../skew%20heap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    skew heap
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../splay/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    splay
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../van%20Emde%20Boas%20Tree/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    van Emde Boas Tree
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    CO
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            CO
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CO/computer%20organization%20and%20design/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    computer organization and design
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    General physics
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            General physics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../general%20physics/General%20Pyhsics%20II/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    General Pyhsics II
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../general%20physics/Geometrical%20Optics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Geometrical Optics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../general%20physics/Schr%C3%B6dinger%20equation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Schrödinger equation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../general%20physics/optical%20conic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    optical conic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../general%20physics/quantum%20computation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    quantum computation
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Misc
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Misc
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../misc/CTF/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CTF-WriteUp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../misc/why%20r%20ur%20head%20sharp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    why r ur head sharp
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    My past
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            My past
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_1" >
        
          
          <label class="md-nav__link" for="__nav_7_1" id="__nav_7_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    MCU
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_1">
            <span class="md-nav__icon md-icon"></span>
            MCU
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/MCU/51/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    51单片机
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_2" >
        
          
          <label class="md-nav__link" for="__nav_7_2" id="__nav_7_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    OI
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2">
            <span class="md-nav__icon md-icon"></span>
            OI
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/0.9loop%3D1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    0.999...=1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/01%E5%BA%8F%E5%88%97/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    将复杂序列问题转换成01序列求解的优化
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/2022%E6%95%B0%E8%81%94%E6%B8%B8%E8%AE%B0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2022数联游记
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/AC%E8%87%AA%E5%8A%A8%E6%9C%BA/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AC自动机
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/CF1896D/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CF1896D
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/CRT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    中国剩余定理
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/CSP-S%202021/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CSP-S 2021
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/DLX/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dancing Links X
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/FFT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    快速傅里叶变换 FFT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/Fast%20IO/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fast io
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/Game%20with%20Marbles%20%28Hard%20Version%29/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CF1914E2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/MST/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    最小生成树MST
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/NOI%20Online%202022/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NOI Online 2022
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/P1633/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    P1633
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/STL/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    STL
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/Trie/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Trie
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/algorithm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    algorithm
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/cstring/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cstring
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/dp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    期望dp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/dp%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dp常用方法
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/dp%E8%BD%AC%E7%A7%BB/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dp转移
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/gcd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    欧几里得&amp;扩展欧几里得
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/kruskal%E9%87%8D%E6%9E%84%E6%A0%91/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    kruskal重构树
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/manacher/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    manacher算法
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/wqs%E4%BA%8C%E5%88%86/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    wqs二分
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/xor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    异或
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/%E4%B8%BB%E5%B8%AD%E6%A0%91/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    主席树
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/%E4%BA%8C%E5%88%86/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    二分
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/%E4%BA%8C%E7%BA%A7%E6%8C%87%E9%92%88/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    二维数组与二级指针
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/%E4%BC%98%E5%85%88%E9%98%9F%E5%88%97/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    优先队列/二叉堆
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/%E4%BC%98%E5%8C%96dp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    斜率优化dp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/%E4%BD%8D%E8%BF%90%E7%AE%97/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    进制 &amp; 位运算
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/%E5%80%8D%E5%A2%9E/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    倍增
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/%E5%87%8F%E5%B0%91%E6%97%A0%E7%94%A8%E7%8A%B6%E6%80%81/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    减少无用状态
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/%E5%88%86%E6%B2%BB/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    分治
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/%E5%8C%BA%E9%97%B4dp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    区间dp总结
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/%E5%8F%8C%E6%8C%87%E9%92%88/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    尺取法 two-pointers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/%E5%9B%BE%E8%AE%BA/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    图论
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/%E5%A4%8D%E6%9D%82%E5%BA%A6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    看似错误的复杂度的渐近处理
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/%E5%B9%B6%E6%9F%A5%E9%9B%86/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    并查集
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/%E6%95%B0%E5%AD%A6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    泰勒级数
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/%E6%9C%80%E7%9F%AD%E8%B7%AF/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    最短路
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/%E6%9E%84%E9%80%A0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    构造
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/%E6%A0%91%E5%BD%A2dp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    树形dp总结
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/%E6%A0%91%E7%9A%84%E7%9B%B4%E5%BE%84/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    树的直径
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/%E6%A0%91%E9%93%BE%E5%89%96%E5%88%86/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    树链剖分
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/%E6%A8%A1%E6%8B%9F/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    模拟
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/%E6%AC%A7%E6%8B%89%E5%87%BD%E6%95%B0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    欧拉函数
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/%E7%82%B9%E5%88%86%E6%B2%BB/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    点分治
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/%E7%8A%B6%E5%8E%8Bdp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    状压dp总结
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/%E7%9F%A9%E9%98%B5%E4%B9%98%E6%B3%95/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    矩阵乘法
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/%E7%A6%BB%E6%95%A3%E5%8C%96_%E5%93%88%E5%B8%8C/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    离散优化
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/%E7%BA%BF%E6%80%A7dp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    线性dp/普通dp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    线性代数
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/%E7%BA%BF%E6%80%A7%E7%AD%9B/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    欧拉筛
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/%E7%BA%BF%E6%AE%B5%E6%A0%91/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    线段树
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/%E7%BA%BF%E6%AE%B5%E6%A0%91%E5%90%88%E5%B9%B6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    线段树合并
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/%E7%BB%93%E6%9E%84%E4%BD%93/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    结构体
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/%E7%BC%A9%E7%82%B9/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    缩点
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/%E7%BD%91%E7%BB%9C%E6%B5%81/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    网络流
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/%E8%83%8C%E5%8C%85/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    背包总结
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    莫比乌斯反演
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/%E8%8E%AB%E9%98%9F/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    莫队
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/%E8%99%9A%E6%A0%91/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    虚树
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/%E8%AE%B0%E5%BF%86%E5%8C%96%E6%90%9C%E7%B4%A2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    记忆化搜索
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/%E8%B4%AA%E5%BF%83/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    贪心
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/%E9%80%86%E5%85%83/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    乘法逆元
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/%E9%80%92%E5%BD%92/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    递归 &amp; 递推
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/%E9%AB%98%E6%96%AF%E6%B6%88%E5%85%83/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    高斯消元
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/OI/%E9%AB%98%E7%B2%BE%E5%BA%A6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    高精度
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_3" >
        
          
          <label class="md-nav__link" for="__nav_7_3" id="__nav_7_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Bangumi
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_3">
            <span class="md-nav__icon md-icon"></span>
            Bangumi
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/bangumi/bangumi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bangumi
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_4" >
        
          
          <label class="md-nav__link" for="__nav_7_4" id="__nav_7_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Python
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_4">
            <span class="md-nav__icon md-icon"></span>
            Python
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/python/Bongo%20Cat/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Python Bongo Cat
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/python/pokemon/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Python Pokemon自动刷怪
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/python/spider/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    python 爬虫总结
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../my%20past/python/tool/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Python常用库/工具
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Probability
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Probability
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../probability/martingale%20and%20stopping%20times/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    martingale and stopping times
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../probability/probability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    probability
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    X86asm
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            X86asm
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../x86asm/ASM/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    asm
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#shor_1" class="md-nav__link">
    <span class="md-ellipsis">
      Shor算法简介
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      量子傅里叶变换
    </span>
  </a>
  
    <nav class="md-nav" aria-label="量子傅里叶变换">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dft" class="md-nav__link">
    <span class="md-ellipsis">
      DFT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qft" class="md-nav__link">
    <span class="md-ellipsis">
      QFT
    </span>
  </a>
  
    <nav class="md-nav" aria-label="QFT">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qft_1" class="md-nav__link">
    <span class="md-ellipsis">
      QFT
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qft_2" class="md-nav__link">
    <span class="md-ellipsis">
      整理 QFT 得出量子电路易实现的形式
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      电路实现
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      模指
    </span>
  </a>
  
    <nav class="md-nav" aria-label="模指">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      量子加法器
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      量子模加器
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      量子可控模乘器
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      模指模块
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qpe" class="md-nav__link">
    <span class="md-ellipsis">
      量子相位估计 QPE
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#shor_2" class="md-nav__link">
    <span class="md-ellipsis">
      Shor 算法
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Shor 算法">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      约化素数因子分解
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fxaxmod-n" class="md-nav__link">
    <span class="md-ellipsis">
      求解 \(f(x)=a^x\mod N\) 的周期
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      电路实现
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<p>我大概一辈子也不会忘记这个算法了</p>
<p>直接把报告贴上来罢</p>
<h1 id="shor">Shor 算法</h1>
<h2 id="shor_1">Shor算法简介</h2>
<p>RSA 难以破解的原因是大素数因子分解的困难性：经典素数分解算法（如试除法、费马分解法等）在处理大整数时需要指数级时间复杂度。</p>
<p>Shor算法在量子计算机上仅需多项式时间完成因数分解，其时间复杂度为 <span class="arithmatex">\(O(l^2\log l \log\log l)\)</span>，因此可以极大加速破解速度，使得 RSA 失效</p>
<h2 id="_1">量子傅里叶变换</h2>
<h3 id="dft">DFT</h3>
<p>经典的傅里叶变换形如：<span class="arithmatex">\(\displaystyle y_k = \frac1{\sqrt{N}} \sum_{j=0}^{N-1}x_j\omega_N^{jk}\)</span></p>
<p>其中 <span class="arithmatex">\(\displaystyle \omega_{N}^{jk} = e^{2\pi i\frac{jk}{N}}\)</span></p>
<h3 id="qft">QFT</h3>
<h4 id="qft_1">QFT</h4>
<p>在量子算法中，量子傅里叶变换实现以下转换:</p>
<p><span class="arithmatex">\(\displaystyle \sum_{j=0}^{N-1}x_j \vert j\rangle \to \sum_{k=0}^{N-1}y_k \vert k\rangle\)</span></p>
<p>即：</p>
<p><span class="arithmatex">\(\displaystyle \vert j\rangle \to \frac1{\sqrt{N}} \sum_{k=0}^{N-1}\omega_N^{jk}\vert k\rangle\)</span></p>
<p>相对应的酉矩阵为 <span class="arithmatex">\(\displaystyle U_{QFT} = \frac1{\sqrt{N}} \sum_{j=0}^{N-1}\sum_{k=0}^{N-1}\omega_N^{jk}\ket{k}\bra{j}\)</span></p>
<p>具体为 </p>
<p><span class="arithmatex">\(\left[
\begin{array}{c} 1&amp;1 &amp;1&amp;\cdots&amp;1 \\\\
1 &amp;\omega_N^1 &amp;\omega_N^2 &amp;\cdots &amp; \omega_N^{N-1}\\\\
1 &amp;\omega_N^2 &amp;\omega_N^4 &amp;\cdots &amp; \omega_N^{2(N-1)}\\\\
\vdots&amp;\vdots&amp;\vdots&amp;\ddots&amp;\vdots\\\\
1 &amp;\omega_N^{N-1} &amp;\omega_N^{2(N-1)} &amp;\cdots &amp; \omega_N^{(N-1)(N-1)}\\\\
\end{array} 
\right]\)</span></p>
<h3 id="qft_2">整理 QFT 得出量子电路易实现的形式</h3>
<p><span class="arithmatex">\(\displaystyle QFT\ket{x}=\frac{1}{\sqrt{N}}\sum_{y=0}^{N-1}\omega_{N}^{xy}\ket{y}\)</span></p>
<p>将 <span class="arithmatex">\(\omega\)</span> 展开，并将 <span class="arithmatex">\(N=2^n\)</span> 代入</p>
<p><span class="arithmatex">\(\displaystyle=\frac{1}{\sqrt{N}}\sum_{y=0}^{N-1}e^{2\pi ixy/2^n}\ket{y}\)</span></p>
<p>将 <span class="arithmatex">\(\displaystyle y/2^n=\sum_{k=1}^n y_k/2^k\)</span> 展开</p>
<p><span class="arithmatex">\(\displaystyle=\frac{1}{\sqrt{N}}\sum_{y=0}^{N-1}e^{2\pi i(\sum_{k=1}^n y_k/2^k)x}\ket{y_1\cdots y_n}\)</span></p>
<p><span class="arithmatex">\(\displaystyle=\frac{1}{\sqrt{N}}\sum_{y=0}^{N-1}\prod_{k=1}^n e^{2\pi ixy_k/2^k}\ket{y_1\cdots y_n}\)</span></p>
<p>这一步将 <span class="arithmatex">\(\displaystyle\sum_{y=0}^{N-1}=\sum_{y_1=0}^1\cdots\sum_{y_n=0}^1\)</span> 展开</p>
<p><span class="arithmatex">\(\displaystyle=\frac{1}{\sqrt{N}}\bigotimes_{k=1}^{n}(\ket 0 + e^{2\pi ix/2^k}\ket{1})\)</span></p>
<p><span class="arithmatex">\(\displaystyle=\frac{1}{\sqrt{N}}(\ket 0 + e^{2\pi ix/2}\ket{1})\otimes(\ket 0 + e^{2\pi ix/2^2}\ket{1})\otimes\cdots\otimes(\ket 0 + e^{2\pi ix/2^n}\ket{1})\)</span></p>
<h3 id="_2">电路实现</h3>
<p>Hadamard 门可以实现 <span class="arithmatex">\(\displaystyle H\ket{x_k}=\frac1{\sqrt2}(\ket0 + \exp(\frac{2\pi i}{2}x_k)\ket1)\)</span> 的功能</p>
<p>除此之外，一个 <span class="arithmatex">\(CROT_k\)</span> 门为 <span class="arithmatex">\(\left[\begin{array}{rcl}I&amp;0\\\\ 0&amp;UROT_k\end{array}\right]\)</span>, 是可控 <span class="arithmatex">\(UROT_k\)</span> 门</p>
<p>其中 <span class="arithmatex">\(UROT_k=\left[\begin{array}{rcl}1&amp;0\\\\ 0&amp;\exp(\frac{2\pi i}{2^k})\end{array}\right]\)</span></p>
<p>我们对两个量子比特 <span class="arithmatex">\(\ket{x_ix_j}\)</span> 施加 <span class="arithmatex">\(CROT_k\)</span> 门，有如下效果：</p>
<p><span class="arithmatex">\(CROT_k\ket{0x_j}=\ket{0x_j}\)</span></p>
<p><span class="arithmatex">\(CROT_k\ket{1x_j}=\exp(\frac{2\pi i}{2^k} x_j)\ket{1x_j}\)</span></p>
<p>所以最终的电路为如下：</p>
<p><img alt="alt text" src="../../images/quantum_pic/image.png" /></p>
<p>运行电路的具体过程如下：</p>
<p>先施加一个 <span class="arithmatex">\(H\)</span> 门：</p>
<p><span class="arithmatex">\(\displaystyle H\vert x_1x_2\ldots x_n\rangle\)</span></p>
<p><span class="arithmatex">\(\displaystyle=\frac{1}{\sqrt{2}}\left[\vert0\rangle + \exp\left(\frac{2\pi i}{2}x_1\right)\vert1\rangle\right]
\otimes\vert x_2x_3\ldots x_n\rangle\)</span></p>
<p>施加 <span class="arithmatex">\(CROT_2\)</span> 门后得到:</p>
<p>$\displaystyle=
\frac{1}{\sqrt{2}}
\left[\vert0\rangle + \exp\left(\frac{2\pi i}{2^2}x_2 + \frac{2\pi i}{2}x_1\right)\vert1\rangle\right]
\otimes
\vert x_2x_3\ldots x_n\rangle
$</p>
<p>施加所有的 <span class="arithmatex">\(CROT\)</span> 门后得到:</p>
<p><span class="arithmatex">\(\displaystyle=
\frac{1}{\sqrt{2}} 
\left[\vert0\rangle +  
\exp\left( 
    \frac{2\pi i}{2^n}x_n +  
    \frac{2\pi i}{2^{n-1}}x_{n-1} +  
    \ldots +  
    \frac{2\pi i}{2^2}x_2 +  
    \frac{2\pi i}{2}x_1 
    \right) 
    \vert1\rangle\right] 
    \otimes 
    \vert x_2x_3\ldots x_n\rangle\)</span></p>
<p>由于
<span class="arithmatex">\(\displaystyle x = 2^{n-1}x_1 + 2^{n-2}x_2 + \ldots + 2^1x_{n-1} + 2^0x_n\)</span></p>
<p>代入得到</p>
<p>$\displaystyle
     \frac{1}{\sqrt{2}} 
     \left[\vert0\rangle +<br />
     \exp\left( 
     \frac{2\pi i}{2^n}x<br />
     \right) 
     \vert1\rangle\right] 
     \otimes 
     \vert x_2x_3\ldots x_n\rangle 
$ </p>
<p>类似地运行完剩余电路，对后 <span class="arithmatex">\(n-1\)</span> 位进行变换，得到：</p>
<p>$\displaystyle= 
     \frac{1}{\sqrt{2}} 
     \left[\vert0\rangle +<br />
     \exp\left( 
     \frac{2\pi i}{2^n}x<br />
     \right) 
     \vert1\rangle\right] 
     \otimes 
     \frac{1}{\sqrt{2}} 
     \left[\vert0\rangle +<br />
     \exp\left( 
     \frac{2\pi i}{2^{n-1}}x<br />
     \right) 
     \vert1\rangle\right] 
     \otimes 
     \ldots 
     \otimes 
     \frac{1}{\sqrt{2}} 
     \left[\vert0\rangle +<br />
     \exp\left( 
     \frac{2\pi i}{2^{2}}x<br />
     \right) 
     \vert1\rangle\right] 
     \otimes 
     \frac{1}{\sqrt{2}} 
     \left[\vert0\rangle +<br />
     \exp\left( 
     \frac{2\pi i}{2^{1}}x<br />
    \right) 
    \vert1\rangle\right] 
$ </p>
<p>注意到此时得到的状态与上面我们推导出的状态在比特位上相反，所以要交换所有的比特来得到最终状态</p>
<h2 id="_3">模指</h2>
<h3 id="_4">量子加法器</h3>
<p><img alt="alt text" src="../../images/quantum_pic/image-1.png" /></p>
<p>上面的 Conditional Phase Shift 模块就是之前的 <span class="arithmatex">\(CROT_k\)</span> 门</p>
<p>那么我们可以如此构造一个电路，注意我们要先做 QFT, 这里的 <span class="arithmatex">\(\phi_i(b)\)</span> 是 QFT 后的第 <span class="arithmatex">\(i\)</span> 位 </p>
<p>这个电路可以记为:</p>
<p><img alt="alt text" src="../../images/quantum_pic/image-2.png" /></p>
<p>所以，利用 QFT 和 IQFT， 我们可以得到一个量子加法器：</p>
<p><img alt="alt text" src="../../images/quantum_pic/image-3.png" /></p>
<h3 id="_5">量子模加器</h3>
<p>使用上面的量子加法器，可以将 QFT 变换后的状态 <span class="arithmatex">\(\ket{\phi(b)}\)</span> 转化为 <span class="arithmatex">\(\ket{\phi(a+b)\mod N}\)</span></p>
<p>这样我们就可以来构造模加器的电路</p>
<p>具体地，我们先将值 <span class="arithmatex">\(b\)</span> 加上一位 <span class="arithmatex">\(\ket{0}\)</span>, 并整体做 QFT, 得到状态 <span class="arithmatex">\(\phi(b)\)</span>；之后施加一个加法器 <span class="arithmatex">\(\Phi ADD(a)\)</span>，得到状态为 <span class="arithmatex">\(\phi(a+b)\)</span> </p>
<p>注意这个 <span class="arithmatex">\(\phi(a+b)\)</span> 由于我们在做 QFT 前量子位多给了一位，所以不会溢出</p>
<p>之后施加一个反门 <span class="arithmatex">\(\Phi ADD(N)\)</span>，得到状态 <span class="arithmatex">\(\phi(a+b-N)\)</span></p>
<p>如果 <span class="arithmatex">\(a+b\geq N\)</span>, 那么我们得到了想要的状态；</p>
<p>如果 <span class="arithmatex">\(a+b&lt;N\)</span>, 那么我们需要将多减去的 <span class="arithmatex">\(N\)</span> 再加回来</p>
<p>这时我们就可以先施加 IQFT 得到 <span class="arithmatex">\(A+B-N\)</span> ，再将最高位作为控制位输出到最下面的辅助位中，再做 QFT 恢复原本的状态</p>
<p>如果最高位为 <span class="arithmatex">\(1\)</span>, 说明 <span class="arithmatex">\(a+b&lt;N\)</span>, 那么我们就施加一个可控加法器 <span class="arithmatex">\(\Phi ADD(N)\)</span> 得到状态 <span class="arithmatex">\(\phi(a+b)\mod N\)</span></p>
<p>这里可控加法器的构造与使用 <span class="arithmatex">\(UROT_k\)</span> 构造 <span class="arithmatex">\(CROT_k\)</span> 的方法类似</p>
<p>此时还剩下最下面的辅助位没有还原，如果不还原辅助位，那么我们的门操作是不可逆的</p>
<p>所以我们按照前一部分类似的方法，将辅助位还原即可</p>
<p>最终得到了模加器的电路</p>
<p>量子模加器的电路图如下：</p>
<p><img alt="alt text" src="../../images/quantum_pic/image-4.png" /></p>
<h3 id="_6">量子可控模乘器</h3>
<p>有了模加器，我们就可以使用 <span class="arithmatex">\(n\)</span> 个模加器构造如下电路：</p>
<p><img alt="alt text" src="../../images/quantum_pic/image-5.png" /></p>
<p>这里 <span class="arithmatex">\(\ket c\)</span> 是控制位</p>
<p>如果 <span class="arithmatex">\(c=1\)</span>, 那么所有模加器都收到使能，可以正常运作；同时如果 <span class="arithmatex">\(x_i=1\)</span>, 那么第 <span class="arithmatex">\(i\)</span> 个加法器两位都使能，就会将状态转换为加上 <span class="arithmatex">\(2^ia\)</span> 后的结果</p>
<p>由于 <span class="arithmatex">\(x=x_0+2x_1+\cdots+2^{n-1}x_n\)</span>, 那么每一位 <span class="arithmatex">\(x_i\)</span> 接在模加器 <span class="arithmatex">\(\Phi ADD(2^ia)\mod N\)</span> 的控制位上，如果 <span class="arithmatex">\(x_i=1\)</span>, 就将结果加上 <span class="arithmatex">\(2^ia\)</span> 并对 <span class="arithmatex">\(N\)</span> 取模</p>
<p>最后得到的结果即为 </p>
<p><span class="arithmatex">\(\left\\{ \begin{array}{l}\ket{(b+a\cdot x)\mod N}&amp;, c=1\\\\ \ket{b}&amp;, c=0\end{array}\right.\)</span></p>
<h3 id="_7">模指模块</h3>
<p>有了模乘器，我们用两个模乘器和一个交换器即可完成最后的模指模块：</p>
<p><img alt="alt text" src="../../images/quantum_pic/image-6.png" /></p>
<p>整个电路运行过程为：</p>
<p><span class="arithmatex">\(\ket x \ket 0 \to\ket x \ket{(a\cdot x)\mod N} \to\ket{(a\cdot x)\mod N} \ket x \to \ket{(a\cdot x)\mod N} \ket {(x-a^{-1}ax)\mod N}=\ket{(a\cdot x)\mod N} \ket 0\)</span></p>
<p>这样在原本的位上得到了模指后的结果，并且将辅助位还原为 <span class="arithmatex">\(0\)</span></p>
<p>对于 <span class="arithmatex">\(U_{a^n}\)</span> 模块，只需要重复 <span class="arithmatex">\(U_a\)</span> 模块 <span class="arithmatex">\(n\)</span> 次即可</p>
<p>对于 <span class="arithmatex">\(U_{a^{2^n}}\)</span>，可以二分构造 <span class="arithmatex">\(U_{a^{2^{n-1}}}\)</span> 模块，然后再合并，可以从合并 <span class="arithmatex">\(O(2^n)\)</span> 次变成合并 <span class="arithmatex">\(O(n)\)</span> 次，从而降低构造的复杂度</p>
<h2 id="qpe">量子相位估计 QPE</h2>
<p>设有一个酉算符 <span class="arithmatex">\(U\)</span> 及其本征态 <span class="arithmatex">\(\ket\psi\)</span>，满足：</p>
<p><span class="arithmatex">\(U\ket \psi = e^{2\pi i\theta}\ket \psi\)</span></p>
<p>其中 <span class="arithmatex">\(\theta\)</span> 是一个未知的实数，称为本征相位（eigenphase）</p>
<p>我们的目的是求出这个 <span class="arithmatex">\(\theta\)</span></p>
<p>首先准备初始态：<span class="arithmatex">\(\ket \phi = \displaystyle\ket 0 ^{\otimes n}\ket \psi\)</span></p>
<p>对于初态作用 <span class="arithmatex">\(H\)</span> 门得到 <span class="arithmatex">\(\displaystyle\ket \phi= \frac1{\sqrt {2^n}}\sum_{k=0}^{2^n-1}\ket k\ket \psi\)</span></p>
<p>依次对工作寄存器中的第 <span class="arithmatex">\(j\)</span> 个比特（从低位到高位）控制地施加 <span class="arithmatex">\(U^{2^j}\)</span> 到数据寄存器上，使系统变为：</p>
<p><span class="arithmatex">\(\displaystyle\ket \phi= \frac1{\sqrt {2^n}}\sum_{k=0}^{2^n-1}\ket kU^k\ket \psi\)</span></p>
<p>由于 <span class="arithmatex">\(U\ket \psi = e^{2\pi i\theta}\ket \psi\)</span>
，代入后得到：</p>
<p><span class="arithmatex">\(\displaystyle\ket \phi= \frac1{\sqrt {2^n}}\sum_{k=0}^{2^n-1}\ket ke^{2\pi i\theta k}\ket \psi\)</span></p>
<p>在工作寄存器上执行逆量子傅里叶变换 IQFT，能够将相位信息 <span class="arithmatex">\(\theta\)</span> 转化为整数表示。</p>
<p>具体地，将 <span class="arithmatex">\(\ket \phi\)</span> 作用 IQFT, 由于 QFT 与 IQFT 表示成：</p>
<p><span class="arithmatex">\(\displaystyle QFT\ket k = \frac1{\sqrt{2^n}}\sum_{j=0}^{2^n-1}e^{2\pi i\frac{kj}{2^n}}\ket j\)</span></p>
<p><span class="arithmatex">\(\displaystyle IQFT\ket j = \frac1{\sqrt{2^n}}\sum_{k=0}^{2^n-1}e^{-2\pi i\frac{kj}{2^n}}\ket k\)</span></p>
<p>那么在前 <span class="arithmatex">\(n\)</span> 位作用 IQFT 后有:</p>
<p><span class="arithmatex">\(\displaystyle IQFT(\frac1{\sqrt {2^n}}\sum_{k=0}^{2^n-1}e^{2\pi i\theta k}\ket k)= \frac1{\sqrt {2^n}}\sum_{k=0}^{2^n-1}e^{2\pi i\theta k}(\frac1{\sqrt{2^n}}\sum_{j=0}^{2^n-1}e^{-2\pi i\frac{kj}{2^n}}\ket j)\)</span></p>
<p><span class="arithmatex">\(\displaystyle=\frac1{ {2^n}}\sum_{k=0}^{2^n-1}\sum_{j=0}^{2^n-1}e^{2\pi i\theta k}(e^{-2\pi i\frac{kj}{2^n}}\ket j) = \frac1{ {2^n}}\sum_{k=0}^{2^n-1}\sum_{j=0}^{2^n-1}e^{2\pi ik(\theta-\frac{j}{2^n})}\ket j\)</span></p>
<p>注意到求和项 <span class="arithmatex">\(\displaystyle S=\sum_{k=0}^{2^n-1}e^{2\pi ik(\theta-\frac{j}{2^n})}\)</span></p>
<p>当 <span class="arithmatex">\(\frac{j}{2^n}=\theta\)</span>, 此时 <span class="arithmatex">\(e^{2\pi ik\cdot 0} =1\)</span>, 则 <span class="arithmatex">\(S=\sum_{k=0}^{2^n-1}1 = 2^n\)</span></p>
<p>当 <span class="arithmatex">\(\frac{j}{2^n}\not=\theta\)</span>, 此时不同的指数项干涉，相位相消，结果为 <span class="arithmatex">\(0\)</span></p>
<p>因此最终状态趋近于 <span class="arithmatex">\(\ket j\)</span>, 我们就可以测量得到 <span class="arithmatex">\(j\)</span>, 再根据这个 <span class="arithmatex">\(j\)</span> 来估计 <span class="arithmatex">\(\theta\)</span></p>
<h2 id="shor_2">Shor 算法</h2>
<h3 id="_8">约化素数因子分解</h3>
<p>素数因子分解问题可以约化为 "求函数 <span class="arithmatex">\(f(x)=a^x\mod N\)</span> 的周期" 问题</p>
<p>具体地，假设一个合数 <span class="arithmatex">\(N=P_1 \cdot P_2\)</span>, 求 <span class="arithmatex">\(P_1, P_2\)</span></p>
<p>现随机取一个整数 <span class="arithmatex">\(y&lt;N\)</span>, 且 <span class="arithmatex">\(\gcd(y,N)=1\)</span></p>
<p>定义阶数 <span class="arithmatex">\(r\)</span> 是使得 <span class="arithmatex">\(y^r=1 \mod N\)</span> 满足的最小正整数</p>
<p>如果 <span class="arithmatex">\(r\)</span> 是奇数，就换一个 <span class="arithmatex">\(y\)</span>;</p>
<p>如果 <span class="arithmatex">\(r\)</span> 是偶数，那么 <span class="arithmatex">\(y^r-1=0\mod N\)</span> 可以变为 <span class="arithmatex">\((y^{r/2}-1)\cdot (y^{r/2}+1) = 0 \mod N\)</span></p>
<p>于是可以设 <span class="arithmatex">\((y^{r/2}-1)\cdot (y^{r/2}+1) = m\cdot N = ts\cdot P_1P_2 = (tP_1) \cdot (sP_2)\)</span></p>
<p>则解为： </p>
<p><span class="arithmatex">\(\left\\{ \begin{array}{l}P_1 = \gcd(y^{r/2}-1, N)\\\\ P_2 = \gcd(y^{r/2}+1, N)
\end{array}\right.\)</span></p>
<p>如果这组解是一组平庸解，即</p>
<p><span class="arithmatex">\(\left\\{ \begin{array}{l}P_1 = \gcd(y^{r/2}-1, N) = 1\\\\ P_2 = \gcd(y^{r/2}+1, N) = N
\end{array}\right.\)</span></p>
<p>那么就换一个 <span class="arithmatex">\(y\)</span>, 否则就求出了 <span class="arithmatex">\(P_1,P_2\)</span></p>
<p>于是问题转化为求解 <span class="arithmatex">\(f(x)=a^x\mod N\)</span> 的周期</p>
<h3 id="fxaxmod-n">求解 <span class="arithmatex">\(f(x)=a^x\mod N\)</span> 的周期</h3>
<p>有了上面的 QFT 模块和模指模块，我们就可以来构造求 <span class="arithmatex">\(f(x)=a^x\mod N\)</span> 的周期的电路了</p>
<p>具体地，对一个状态 <span class="arithmatex">\(\ket y\)</span> 施加模指电路后得到：</p>
<p><span class="arithmatex">\(\displaystyle U_a\ket y=\ket{ay\mod N}\)</span></p>
<p>注意到 <span class="arithmatex">\(U_a\)</span> 可以视为一个量子门，即对应着一个矩阵</p>
<p>我们想要知道这个矩阵的特征值</p>
<p>举一个 <span class="arithmatex">\(a=7,N=15\)</span> 的例子：</p>
<p><span class="arithmatex">\(\displaystyle U_a\ket1 = \ket 7\)</span></p>
<p><span class="arithmatex">\(\displaystyle U_a^2\ket1 = U_{a^2}= \ket 4\)</span></p>
<p><span class="arithmatex">\(\displaystyle U_a^3\ket1 = U_{a^3}= \ket {13}\)</span></p>
<p><span class="arithmatex">\(\displaystyle U_a^4\ket1 = U_{a^4}= \ket 1\)</span></p>
<p>可以看到 <span class="arithmatex">\(f(x)=a^x\mod N\)</span> 的阶数 <span class="arithmatex">\(r=4\)</span>, 而状态也在 <span class="arithmatex">\(4\)</span> 次变换后回到 <span class="arithmatex">\(\ket 1\)</span></p>
<p>所以构造一个状态 <span class="arithmatex">\(\ket {u_0}=\frac1{\sqrt r}\sum_{k=0}^{r-1}\ket{a^k\mod N}\)</span></p>
<p>则 <span class="arithmatex">\(U_a\ket {u_0}=\frac1{\sqrt r}\sum_{k=0}^{r-1}U_a\ket{a^k\mod N} = \frac1{\sqrt r}\sum_{k=0}^{r-1}\ket{a^{k+1}\mod N} = \ket {u_0}\)</span></p>
<p>所以 <span class="arithmatex">\(\ket{u_0}\)</span> 是矩阵的一个特征向量，对应的一个特征值为 <span class="arithmatex">\(1\)</span></p>
<p>进一步，我们构造 <span class="arithmatex">\(\ket {u_s} = \frac1{\sqrt r}\sum_{k=0}^{r-1}e^{-\frac{2\pi isk}r}\ket{a^k\mod N}\)</span>, 可以得到 <span class="arithmatex">\(U_a\ket {u_s} = e^{\frac{2\pi is}r}\ket {u_s}\)</span></p>
<p>这些特征值/特征向量十分特殊，因为他们包含了我们要求的周期：<span class="arithmatex">\(r\)</span></p>
<p>这时我们将所有 <span class="arithmatex">\(\ket {u_s}\)</span> 相加，可以使得除了 <span class="arithmatex">\(\ket1\)</span> 的所有状态的相位抵消, 即 <span class="arithmatex">\(\frac1{\sqrt r}\sum_{s=0}^{r-1}\ket{u_s}=\ket 1\)</span></p>
<p>具体地，对于 <span class="arithmatex">\(a=7,N=15,r=4\)</span>:</p>
<p><span class="arithmatex">\(|u_0\rangle = \tfrac{1}{2}(|1\rangle \hphantom{e^{-\tfrac{2\pi i}{12}}}+ |7\rangle \hphantom{e^{-\tfrac{12\pi i}{12}}} + |4\rangle \hphantom{e^{-\tfrac{12\pi i}{12}}} + |13\rangle)\)</span></p>
<p><span class="arithmatex">\(|u_1\rangle = \tfrac{1}{2}(|1\rangle + e^{-\tfrac{2\pi i}{4}}|7\rangle + e^{-\tfrac{\hphantom{1}4\pi i}{4}}|4\rangle + e^{-\tfrac{\hphantom{1}6\pi i}{4}}|13\rangle)\)</span></p>
<p><span class="arithmatex">\(|u_2\rangle = \tfrac{1}{2}(|1\rangle + e^{-\tfrac{4\pi i}{4}}|7\rangle + e^{-\tfrac{\hphantom{1}8\pi i}{4}}|4\rangle + e^{-\tfrac{12\pi i}{4}}|13\rangle)\)</span></p>
<p><span class="arithmatex">\(|u_3\rangle = \tfrac{1}{2}(|1\rangle + e^{-\tfrac{6\pi i}{4}}|7\rangle + e^{-\tfrac{12\pi i}{4}}|4\rangle + e^{-\tfrac{18\pi i}{4}}|13\rangle)\)</span></p>
<p><span class="arithmatex">\(\therefore \frac12(\ket{u_0} + \ket{u_1} + \ket{u_2} + \ket{u_3} )= |1\rangle\)</span></p>
<p>由于 <span class="arithmatex">\(\ket1\)</span> 是这些特征向量的叠加态，所以，如果我们将 <span class="arithmatex">\(\ket1\)</span> 作为 <span class="arithmatex">\(\ket \psi\)</span> 做 QPE (量子相位估计)， 那么我们会得到一个相位估计值：</p>
<p><span class="arithmatex">\(\displaystyle\phi = \frac sr\)</span></p>
<p>其中 <span class="arithmatex">\(s\in[0,r-1]\)</span> 是一个随机值</p>
<p>这样，我们对 <span class="arithmatex">\(\phi\)</span> 做连分数即可估计出 <span class="arithmatex">\(s\)</span> 和 <span class="arithmatex">\(r\)</span></p>
<p>如果 <span class="arithmatex">\(\gcd(s,r)=1\)</span>, 那么我们就得出了最终结果 <span class="arithmatex">\(r\)</span>;</p>
<p>否则，结果为 <span class="arithmatex">\(\frac r{\gcd(s,r)}\)</span>, 不是我们想要的结果</p>
<p>但是，根据数论的一些定理，结果正确的概率为 <span class="arithmatex">\(\frac1{\log\log r}\)</span>, 所以期望在 <span class="arithmatex">\(O(\log\log r)\)</span> 步得出正确的 <span class="arithmatex">\(r\)</span></p>
<p>至此，Shor 算法的主要流程便介绍完毕了</p>
<h2 id="_9">电路实现</h2>
<p>为了保证精确度，我们可以使用 <span class="arithmatex">\(2n\)</span> 个量子比特来做 QFT 和 QPE，<span class="arithmatex">\(n\)</span> 个量子比特来做模指</p>
<p>具体地，先作用 <span class="arithmatex">\(H\)</span> 门，得到初态 <span class="arithmatex">\(\displaystyle\ket\phi = \frac1{\sqrt {2^{2n}}}\sum_{x=0}^{ {2^{2n}}-1}\ket x \ket 1\)</span></p>
<p>然后将 <span class="arithmatex">\(2n\)</span> 个模指模块的控制位接到 <span class="arithmatex">\(2n\)</span> 个量子位，经过这一步原先状态变为 <span class="arithmatex">\(\displaystyle\ket\phi = \frac1{\sqrt {2^{2n}}}\sum_{x=0}^{ {2^{2n}}-1}\ket x\ket{f(x)}\)</span></p>
<p>这里 <span class="arithmatex">\(\ket{f(x)}=\ket{a^x\mod N}=U_a^x\ket1\)</span></p>
<p>由于 <span class="arithmatex">\(\ket 1 = \frac1{\sqrt r}\sum_{s=0}^{r-1}\ket{u_s}\)</span>, 并且 <span class="arithmatex">\(U_a\ket {u_s} = e^{\frac{2\pi is}r}\ket {u_s}\)</span></p>
<p>所以原状态可以展开为：</p>
<p><span class="arithmatex">\(\displaystyle\ket\phi = \frac1{\sqrt {2^{2n}}}\sum_{x=0}^{ {2^{2n}}-1}\ket x\frac1{\sqrt r}\sum_{s=0}^{r-1}U_a^x\ket{u_s}\)</span></p>
<p><span class="arithmatex">\(\displaystyle= \frac1{\sqrt {2^{2n}}}\frac1{\sqrt r}\sum_{x=0}^{ {2^{2n}}-1}\sum_{s=0}^{r-1}e^{\frac{2\pi is}r\cdot x}\ket x\ket{u_s}\)</span></p>
<p>那么在前 <span class="arithmatex">\(2n\)</span> 位作用 IQFT 后有:</p>
<p><span class="arithmatex">\(\displaystyle IQFT(\ket \phi)= \frac1{\sqrt {2^{2n}}}\frac1{\sqrt r}\sum_{x=0}^{ {2^{2n}}-1}(\frac1{\sqrt {2^{2n}}}\sum_{j=0}^{2^{2n}-1}e^{-2\pi i\frac{xj}{2^{2n}}}\ket j)\sum_{s=0}^{r-1}e^{\frac{2\pi is}r\cdot x}\)</span></p>
<p><span class="arithmatex">\(\displaystyle=\frac1{ {2^{2n}}}\frac1{\sqrt r}\sum_{x=0}^{ {2^{2n}}-1}\sum_{j=0}^{2^{2n}-1}\sum_{s=0}^{r-1}(e^{\frac{2\pi is}r\cdot x}\cdot e^{-2\pi i\frac{xj}{2^{2n}}}\ket j)\)</span></p>
<p><span class="arithmatex">\(\displaystyle=\frac1{ {2^{2n}}}\frac1{\sqrt r}\sum_{x=0}^{ {2^{2n}}-1}\sum_{j=0}^{2^{2n}-1}\sum_{s=0}^{r-1}(e^{2\pi ix(\frac{s}{r}-\frac{j}{2^{2n}})}\ket j)\)</span></p>
<p>注意到求和项 <span class="arithmatex">\(\displaystyle S=\sum_{x=0}^{ {2^{2n}}-1}e^{2\pi ix(\frac{s}{r}-\frac{j}{2^{2n}})}\)</span></p>
<p>当 <span class="arithmatex">\(\frac{j}{2^{2n}}=\frac{s}{r}\)</span>, 此时 <span class="arithmatex">\(e^{2\pi ix\cdot 0} =1\)</span>, 则 <span class="arithmatex">\(S= 2^{2n}\)</span></p>
<p>当 <span class="arithmatex">\(\frac{j}{2^{2n}}\not=\frac{s}{r}\)</span>, 此时不同的指数项干涉，相位相消，结果为 <span class="arithmatex">\(0\)</span></p>
<p>所以最终表达式为 <span class="arithmatex">\(\displaystyle\ket \phi=\frac1{\sqrt r}\sum_{j=0}^{2^{2n}-1}\sum_{s=0}^{r-1}\delta_{\frac sr, \frac j{2^{2n}}}\ket j = \frac1{\sqrt r}\sum_{\frac sr = \frac j{2^{2n}}}\ket j\)</span></p>
<p>这说明最终的状态趋近于 <span class="arithmatex">\(r\)</span> 个 <span class="arithmatex">\(\ket j\)</span> 叠加，我们只需要测量就可以以 <span class="arithmatex">\(\frac1r\)</span> 的等概率得到任意一个 <span class="arithmatex">\(j\)</span>, 进而可以得到 <span class="arithmatex">\(\theta = \frac sr\)</span></p>
<p>最终的线路图如下：</p>
<p><img alt="alt text" src="../../images/quantum_pic/image-7.png" /></p>
<h1 id="_10">实验操作</h1>
<h2 id="_11">实验方法</h2>
<p>由于大数分解对应的 Shor 算法中的模指模块较难实现，并且真正的大数在 IBM 的量子计算机上分解比较困难；</p>
<p>相对来说，对于 <span class="arithmatex">\(N=15\)</span> 的小样例模指模块较容易实现，并且真机上运行效果会更好，所以本次课题选择在真机上提交 <span class="arithmatex">\(N=15\)</span> 的小样例来运行，同时在经典计算机上模拟 <span class="arithmatex">\(N=15\)</span> 的小样例观察模拟结果</p>
<h2 id="_12">实验步骤</h2>
<h3 id="_13">仿真</h3>
<h4 id="_14">构建模指模块</h4>
<p>模指模块 <span class="arithmatex">\(U_a\)</span> 需要两个参数: <span class="arithmatex">\(a,N\)</span></p>
<p>对于 <span class="arithmatex">\(N=15\)</span>, 我们选择的 <span class="arithmatex">\(a\)</span> 需要与 <span class="arithmatex">\(N\)</span> 互质，所以要先判断两者是否互质</p>
<p>由于 <span class="arithmatex">\(N=15=2^4-1\)</span>, 这与 <span class="arithmatex">\(4\)</span> 位二进制数的最大值相同，所以对 <span class="arithmatex">\(N\)</span> 取模实质上就是二进制数自然溢出的过程，所以只需要构造如下代码即可：</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">U_a</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">power</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">gcd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;gcd(a, N) is not 1&quot;</span><span class="p">)</span>
    <span class="n">U</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="n">QUBIT</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">_iteration</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">power</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">a</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">13</span><span class="p">]:</span>
            <span class="n">U</span><span class="o">.</span><span class="n">swap</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
            <span class="n">U</span><span class="o">.</span><span class="n">swap</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">U</span><span class="o">.</span><span class="n">swap</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">a</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">]:</span>
            <span class="n">U</span><span class="o">.</span><span class="n">swap</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">U</span><span class="o">.</span><span class="n">swap</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">U</span><span class="o">.</span><span class="n">swap</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">a</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">11</span><span class="p">]:</span>
            <span class="n">U</span><span class="o">.</span><span class="n">swap</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
            <span class="n">U</span><span class="o">.</span><span class="n">swap</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">a</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">13</span><span class="p">]:</span>
            <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
                <span class="n">U</span><span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
    <span class="n">U</span> <span class="o">=</span> <span class="n">U</span><span class="o">.</span><span class="n">to_gate</span><span class="p">()</span>
    <span class="n">U</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s2">^</span><span class="si">{</span><span class="n">power</span><span class="si">}</span><span class="s2"> mod N&quot;</span>
    <span class="n">c_U</span> <span class="o">=</span> <span class="n">U</span><span class="o">.</span><span class="n">control</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">c_U</span>
</code></pre></div>
<h4 id="iqft">逆量子傅里叶变换 IQFT</h4>
<p>对于 <span class="arithmatex">\(n\)</span> 位的 IQFT, 先将所有位施加交换门 <span class="arithmatex">\(SWAP\)</span>，然后对于第 <span class="arithmatex">\(i\)</span> 位，施加 <span class="arithmatex">\(n-i\)</span> 个 <span class="arithmatex">\(UROT\)</span> 门，最后加上 <span class="arithmatex">\(H\)</span> 门，即可完成 QFT 电路的构造</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">QFT</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">qc</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">qubit</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span> <span class="o">//</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">qc</span><span class="o">.</span><span class="n">swap</span><span class="p">(</span><span class="n">qubit</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="n">qubit</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">):</span>
            <span class="n">qc</span><span class="o">.</span><span class="n">cp</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="n">m</span><span class="p">)),</span> <span class="n">m</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
        <span class="n">qc</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
    <span class="n">qc</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;QFT†&quot;</span>
    <span class="k">return</span> <span class="n">qc</span>
</code></pre></div>
<h4 id="qpe_1">量子相位估计 QPE</h4>
<p>定义两个常数 <span class="arithmatex">\(N-COUNT = 2n = 8, QUBIT = n = 4\)</span></p>
<p>创建一个 <span class="arithmatex">\(2n+n\)</span> 位的量子电路，并给前 <span class="arithmatex">\(2n\)</span> 位作用 <span class="arithmatex">\(H\)</span> 门；</p>
<p>之后为后 <span class="arithmatex">\(n\)</span> 位作用模指门，每个们控制位连接到前 <span class="arithmatex">\(2n\)</span> 位上；</p>
<p>再对前 <span class="arithmatex">\(2n\)</span> 位做 IQFT, 最后测量即可得到相位 <span class="arithmatex">\(\phi=s/r\)</span></p>
<div class="highlight"><pre><span></span><code><span class="n">QUBIT</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">N_COUNT</span> <span class="o">=</span> <span class="mi">8</span>

<span class="k">def</span><span class="w"> </span><span class="nf">get_phase</span><span class="p">(</span><span class="n">job</span><span class="p">):</span>
    <span class="n">counts</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="n">result</span><span class="p">()</span><span class="o">.</span><span class="n">get_counts</span><span class="p">()</span>
    <span class="n">count_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">counts</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
    <span class="n">count_list</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">count_list</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Register Reading: &quot;</span> <span class="o">+</span> <span class="n">count_list</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">phase</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">count_list</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">N_COUNT</span><span class="p">)</span> <span class="c1"># phi = s / r</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Corresponding Phase: </span><span class="si">{</span><span class="n">phase</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">phase</span>


<span class="k">def</span><span class="w"> </span><span class="nf">simulate</span><span class="p">(</span><span class="n">qc</span><span class="p">):</span>
    <span class="n">aer_sim</span> <span class="o">=</span> <span class="n">Aer</span><span class="o">.</span><span class="n">Aer</span><span class="o">.</span><span class="n">get_backend</span><span class="p">(</span><span class="s1">&#39;aer_simulator&#39;</span><span class="p">)</span>
    <span class="n">job</span> <span class="o">=</span> <span class="n">aer_sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">transpile</span><span class="p">(</span><span class="n">qc</span><span class="p">,</span> <span class="n">aer_sim</span><span class="p">),</span> <span class="n">memory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">job</span>


<span class="k">def</span><span class="w"> </span><span class="nf">QPE</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
    <span class="n">qc</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="n">QUBIT</span> <span class="o">+</span> <span class="n">N_COUNT</span><span class="p">,</span> <span class="n">N_COUNT</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_COUNT</span><span class="p">):</span>
        <span class="n">qc</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>  <span class="c1"># Initialize counting qubits in state |+&gt;</span>
    <span class="n">qc</span><span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="n">N_COUNT</span><span class="p">)</span>  <span class="c1"># And auxiliary register in state |1&gt;</span>
    <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_COUNT</span><span class="p">):</span>  <span class="c1"># Do controlled-U operations</span>
        <span class="n">qc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">U_a</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">q</span><span class="p">),</span>
                  <span class="p">[</span><span class="n">q</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">N_COUNT</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">QUBIT</span><span class="p">)])</span>
    <span class="n">qc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">QFT</span><span class="p">(</span><span class="n">N_COUNT</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_COUNT</span><span class="p">))</span>  <span class="c1"># Do inverse-QFT</span>
    <span class="n">qc</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">N_COUNT</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_COUNT</span><span class="p">))</span>
    <span class="c1"># Simulate Results</span>
    <span class="n">job</span> <span class="o">=</span> <span class="n">simulate</span><span class="p">(</span><span class="n">qc</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">get_phase</span><span class="p">(</span><span class="n">job</span><span class="p">)</span>
</code></pre></div>
<h4 id="_15">连分数计算周期</h4>
<p>在得到相位 <span class="arithmatex">\(\phi\)</span> 后，就可以对 <span class="arithmatex">\(\phi\)</span> 做连分数得到 <span class="arithmatex">\(r\)</span></p>
<p>随后求出两个因子 <span class="arithmatex">\(\gcd(y^{r/2}+1,N),\gcd(y^{r/2}-1,N)\)</span></p>
<p>如果两个因子是平凡的 <span class="arithmatex">\(1,N\)</span>, 就重新选取 <span class="arithmatex">\(y\)</span>; 否则就得到了答案</p>
<p>代码如下：</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">Shor</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">FACTOR_FOUND</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">ATTEMPT</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="ow">not</span> <span class="n">FACTOR_FOUND</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">a</span> <span class="o">%</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">gcd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">ATTEMPT</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">ATTEMPT </span><span class="si">{</span><span class="n">ATTEMPT</span><span class="si">}</span><span class="s2">: a = </span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">phase</span> <span class="o">=</span> <span class="n">QPE</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>  <span class="c1"># Phase = s/r</span>
        <span class="n">frac</span> <span class="o">=</span> <span class="n">Fraction</span><span class="p">(</span><span class="n">phase</span><span class="p">)</span><span class="o">.</span><span class="n">limit_denominator</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">frac</span><span class="o">.</span><span class="n">denominator</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Result: r = </span><span class="si">{</span><span class="n">r</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>


        <span class="k">if</span> <span class="n">phase</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">guesses</span> <span class="o">=</span> <span class="p">[</span><span class="n">gcd</span><span class="p">(</span><span class="n">a</span> <span class="o">**</span> <span class="p">(</span><span class="n">r</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">),</span> <span class="n">gcd</span><span class="p">(</span><span class="n">a</span> <span class="o">**</span> <span class="p">(</span><span class="n">r</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">)]</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Guessed Factors: </span><span class="si">{</span><span class="n">guesses</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="n">guesses</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">guess</span> <span class="ow">in</span> <span class="n">guesses</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">guess</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">]</span> <span class="ow">and</span> <span class="p">(</span><span class="n">N</span> <span class="o">%</span> <span class="n">guess</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;*** Non-trivial factor found: </span><span class="si">{</span><span class="n">guess</span><span class="si">}</span><span class="s2"> ***&quot;</span><span class="p">)</span>
                    <span class="n">FACTOR_FOUND</span> <span class="o">=</span> <span class="kc">True</span>
</code></pre></div>
<h4 id="_16">完整代码</h4>
<p>最后的完整代码如下:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qiskit</span><span class="w"> </span><span class="kn">import</span> <span class="n">QuantumCircuit</span><span class="p">,</span> <span class="n">transpile</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">qiskit_aer</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">Aer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">math</span><span class="w"> </span><span class="kn">import</span> <span class="n">gcd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">fractions</span><span class="w"> </span><span class="kn">import</span> <span class="n">Fraction</span>

<span class="n">QUBIT</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">N_COUNT</span> <span class="o">=</span> <span class="mi">8</span>

<span class="k">def</span><span class="w"> </span><span class="nf">U_a</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">power</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">gcd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;gcd(a, N) is not 1&quot;</span><span class="p">)</span>
    <span class="n">U</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="n">QUBIT</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">_iteration</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">power</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">a</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">13</span><span class="p">]:</span>
            <span class="n">U</span><span class="o">.</span><span class="n">swap</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
            <span class="n">U</span><span class="o">.</span><span class="n">swap</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">U</span><span class="o">.</span><span class="n">swap</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">a</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">]:</span>
            <span class="n">U</span><span class="o">.</span><span class="n">swap</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">U</span><span class="o">.</span><span class="n">swap</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">U</span><span class="o">.</span><span class="n">swap</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">a</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">11</span><span class="p">]:</span>
            <span class="n">U</span><span class="o">.</span><span class="n">swap</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
            <span class="n">U</span><span class="o">.</span><span class="n">swap</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">a</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">13</span><span class="p">]:</span>
            <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
                <span class="n">U</span><span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
    <span class="n">U</span> <span class="o">=</span> <span class="n">U</span><span class="o">.</span><span class="n">to_gate</span><span class="p">()</span>
    <span class="n">U</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s2">^</span><span class="si">{</span><span class="n">power</span><span class="si">}</span><span class="s2"> mod N&quot;</span>


    <span class="n">c_U</span> <span class="o">=</span> <span class="n">U</span><span class="o">.</span><span class="n">control</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">c_U</span>


<span class="k">def</span><span class="w"> </span><span class="nf">QFT</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">qc</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">qubit</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span> <span class="o">//</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">qc</span><span class="o">.</span><span class="n">swap</span><span class="p">(</span><span class="n">qubit</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="n">qubit</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">):</span>
            <span class="n">qc</span><span class="o">.</span><span class="n">cp</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="n">m</span><span class="p">)),</span> <span class="n">m</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
        <span class="n">qc</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
    <span class="n">qc</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;QFT†&quot;</span>
    <span class="k">return</span> <span class="n">qc</span>


<span class="k">def</span><span class="w"> </span><span class="nf">get_phase</span><span class="p">(</span><span class="n">job</span><span class="p">):</span>
    <span class="n">counts</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="n">result</span><span class="p">()</span><span class="o">.</span><span class="n">get_counts</span><span class="p">()</span>
    <span class="n">count_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">counts</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
    <span class="n">count_list</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">count_list</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Register Reading: &quot;</span> <span class="o">+</span> <span class="n">count_list</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">phase</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">count_list</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">N_COUNT</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Corresponding Phase: </span><span class="si">{</span><span class="n">phase</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">phase</span>


<span class="k">def</span><span class="w"> </span><span class="nf">simulate</span><span class="p">(</span><span class="n">qc</span><span class="p">):</span>
    <span class="n">aer_sim</span> <span class="o">=</span> <span class="n">Aer</span><span class="o">.</span><span class="n">Aer</span><span class="o">.</span><span class="n">get_backend</span><span class="p">(</span><span class="s1">&#39;aer_simulator&#39;</span><span class="p">)</span>
    <span class="n">job</span> <span class="o">=</span> <span class="n">aer_sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">transpile</span><span class="p">(</span><span class="n">qc</span><span class="p">,</span> <span class="n">aer_sim</span><span class="p">),</span> <span class="n">memory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">job</span>


<span class="k">def</span><span class="w"> </span><span class="nf">QPE</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
    <span class="n">qc</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="n">QUBIT</span> <span class="o">+</span> <span class="n">N_COUNT</span><span class="p">,</span> <span class="n">N_COUNT</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_COUNT</span><span class="p">):</span>
        <span class="n">qc</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>  <span class="c1"># Initialize counting qubits in state |+&gt;</span>
    <span class="n">qc</span><span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="n">N_COUNT</span><span class="p">)</span>  <span class="c1"># And auxiliary register in state |1&gt;</span>
    <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_COUNT</span><span class="p">):</span>  <span class="c1"># Do controlled-U operations</span>
        <span class="n">qc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">U_a</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">q</span><span class="p">),</span>
                  <span class="p">[</span><span class="n">q</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">N_COUNT</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">QUBIT</span><span class="p">)])</span>
    <span class="n">qc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">QFT</span><span class="p">(</span><span class="n">N_COUNT</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_COUNT</span><span class="p">))</span>  <span class="c1"># Do inverse-QFT</span>
    <span class="n">qc</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">N_COUNT</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_COUNT</span><span class="p">))</span>
    <span class="c1"># Simulate Results</span>
    <span class="n">job</span> <span class="o">=</span> <span class="n">simulate</span><span class="p">(</span><span class="n">qc</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">get_phase</span><span class="p">(</span><span class="n">job</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">Shor</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">FACTOR_FOUND</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">ATTEMPT</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="ow">not</span> <span class="n">FACTOR_FOUND</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">a</span> <span class="o">%</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">gcd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">ATTEMPT</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">ATTEMPT </span><span class="si">{</span><span class="n">ATTEMPT</span><span class="si">}</span><span class="s2">: a = </span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">phase</span> <span class="o">=</span> <span class="n">QPE</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>  <span class="c1"># Phase = s/r</span>
        <span class="n">frac</span> <span class="o">=</span> <span class="n">Fraction</span><span class="p">(</span><span class="n">phase</span><span class="p">)</span><span class="o">.</span><span class="n">limit_denominator</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">frac</span><span class="o">.</span><span class="n">denominator</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Result: r = </span><span class="si">{</span><span class="n">r</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">phase</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># Guesses for factors are gcd(x^{r/2} ±1 , 15)</span>
            <span class="n">guesses</span> <span class="o">=</span> <span class="p">[</span><span class="n">gcd</span><span class="p">(</span><span class="n">a</span> <span class="o">**</span> <span class="p">(</span><span class="n">r</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">),</span> <span class="n">gcd</span><span class="p">(</span><span class="n">a</span> <span class="o">**</span> <span class="p">(</span><span class="n">r</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">)]</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Guessed Factors: </span><span class="si">{</span><span class="n">guesses</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="n">guesses</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">guess</span> <span class="ow">in</span> <span class="n">guesses</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">guess</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">]</span> <span class="ow">and</span> <span class="p">(</span><span class="n">N</span> <span class="o">%</span> <span class="n">guess</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="c1"># Guess is a factor!</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;*** Non-trivial factor found: </span><span class="si">{</span><span class="n">guess</span><span class="si">}</span><span class="s2"> ***&quot;</span><span class="p">)</span>
                    <span class="n">FACTOR_FOUND</span> <span class="o">=</span> <span class="kc">True</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">Shor</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
</code></pre></div>
<h3 id="_17">提交到真机</h3>
<h4 id="python-ibm-api-token">在 python 中绑定 IBM 用户与 api-token</h4>
<p>注册 IBM 用户后获取 api-token, 即可提交任务</p>
<p>绑定用户并运行电路的代码如下：</p>
<div class="highlight"><pre><span></span><code><span class="n">api_token</span> <span class="o">=</span> <span class="s2">&quot;...&quot;</span> <span class="c1"># 在 IBM 官网上获取到 api-token</span>

<span class="k">def</span><span class="w"> </span><span class="nf">account</span><span class="p">():</span>
    <span class="n">QiskitRuntimeService</span><span class="o">.</span><span class="n">save_account</span><span class="p">(</span><span class="n">channel</span><span class="o">=</span><span class="s2">&quot;ibm_quantum&quot;</span><span class="p">,</span> 
        <span class="n">token</span><span class="o">=</span><span class="n">api_token</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">set_as_default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">service</span> <span class="o">=</span> <span class="n">QiskitRuntimeService</span><span class="p">(</span><span class="n">channel</span><span class="o">=</span><span class="s2">&quot;ibm_quantum&quot;</span><span class="p">)</span>
    <span class="n">backend</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">least_busy</span><span class="p">(</span><span class="n">operational</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">simulator</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">min_num_qubits</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">backend</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">backend</span>


<span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="n">qc</span><span class="p">,</span> <span class="n">backend</span><span class="p">):</span>
    <span class="n">job</span> <span class="o">=</span> <span class="n">backend</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">transpile</span><span class="p">(</span><span class="n">qc</span><span class="p">,</span> <span class="n">backend</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;任务已提交，任务 ID:&quot;</span><span class="p">,</span> <span class="n">job</span><span class="o">.</span><span class="n">job_id</span><span class="p">())</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">job_status</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="n">status</span><span class="p">()</span>
        <span class="c1"># 如果任务完成，获取结果</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">job</span><span class="o">.</span><span class="n">running</span><span class="p">():</span>
            <span class="k">break</span>
    <span class="k">return</span> <span class="n">job</span>
</code></pre></div>
<h4 id="_18">完整代码</h4>
<p>最终的完整代码如下:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qiskit</span><span class="w"> </span><span class="kn">import</span> <span class="n">QuantumCircuit</span><span class="p">,</span> <span class="n">transpile</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qiskit_ibm_runtime</span><span class="w"> </span><span class="kn">import</span> <span class="n">QiskitRuntimeService</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">qiskit_aer</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">Aer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">math</span><span class="w"> </span><span class="kn">import</span> <span class="n">gcd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">fractions</span><span class="w"> </span><span class="kn">import</span> <span class="n">Fraction</span>

<span class="n">QUBIT</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">N_COUNT</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">api_token</span> <span class="o">=</span> <span class="s2">&quot;546d02ef0ab61d9bcb1f6ae7e0c138059d122b1319057b6e1eb7fcea029cb</span>
    <span class="mi">04</span><span class="n">ccd072f9792890991fee88f2f0c66942f25809413fb95597a54e84ede989e7923</span><span class="s2">&quot;</span>


<span class="k">def</span><span class="w"> </span><span class="nf">QFT</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">qc</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">qubit</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span> <span class="o">//</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">qc</span><span class="o">.</span><span class="n">swap</span><span class="p">(</span><span class="n">qubit</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="n">qubit</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">):</span>
            <span class="n">qc</span><span class="o">.</span><span class="n">cp</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="n">m</span><span class="p">)),</span> <span class="n">m</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
        <span class="n">qc</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
    <span class="n">qc</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;QFT†&quot;</span>
    <span class="k">return</span> <span class="n">qc</span>   


<span class="k">def</span><span class="w"> </span><span class="nf">U_a</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">power</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">gcd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;gcd(a, N) is not 1&quot;</span><span class="p">)</span>
    <span class="n">U</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="n">QUBIT</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">_iteration</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">power</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">a</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">13</span><span class="p">]:</span>
            <span class="n">U</span><span class="o">.</span><span class="n">swap</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
            <span class="n">U</span><span class="o">.</span><span class="n">swap</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">U</span><span class="o">.</span><span class="n">swap</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">a</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">]:</span>
            <span class="n">U</span><span class="o">.</span><span class="n">swap</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">U</span><span class="o">.</span><span class="n">swap</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">U</span><span class="o">.</span><span class="n">swap</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">a</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">11</span><span class="p">]:</span>
            <span class="n">U</span><span class="o">.</span><span class="n">swap</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
            <span class="n">U</span><span class="o">.</span><span class="n">swap</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">a</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">13</span><span class="p">]:</span>
            <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
                <span class="n">U</span><span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
    <span class="n">U</span> <span class="o">=</span> <span class="n">U</span><span class="o">.</span><span class="n">to_gate</span><span class="p">()</span>
    <span class="n">U</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s2">^</span><span class="si">{</span><span class="n">power</span><span class="si">}</span><span class="s2"> mod N&quot;</span>
    <span class="n">c_U</span> <span class="o">=</span> <span class="n">U</span><span class="o">.</span><span class="n">control</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">c_U</span>

<span class="k">def</span><span class="w"> </span><span class="nf">get_phase</span><span class="p">(</span><span class="n">job</span><span class="p">):</span>
    <span class="n">counts</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="n">result</span><span class="p">()</span><span class="o">.</span><span class="n">get_counts</span><span class="p">()</span>
    <span class="n">count_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">counts</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
    <span class="n">count_list</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">count_list</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Register Reading: &quot;</span> <span class="o">+</span> <span class="n">count_list</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">phase</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">count_list</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">N_COUNT</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Corresponding Phase: </span><span class="si">{</span><span class="n">phase</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">phase</span>



<span class="k">def</span><span class="w"> </span><span class="nf">simulate</span><span class="p">(</span><span class="n">qc</span><span class="p">):</span>
    <span class="n">aer_sim</span> <span class="o">=</span> <span class="n">Aer</span><span class="o">.</span><span class="n">Aer</span><span class="o">.</span><span class="n">get_backend</span><span class="p">(</span><span class="s1">&#39;aer_simulator&#39;</span><span class="p">)</span>
    <span class="n">job</span> <span class="o">=</span> <span class="n">aer_sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">transpile</span><span class="p">(</span><span class="n">qc</span><span class="p">,</span> <span class="n">aer_sim</span><span class="p">),</span> <span class="n">memory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">job</span>


<span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="n">qc</span><span class="p">,</span> <span class="n">backend</span><span class="p">):</span>
    <span class="n">job</span> <span class="o">=</span> <span class="n">backend</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">transpile</span><span class="p">(</span><span class="n">qc</span><span class="p">,</span> <span class="n">backend</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;任务已提交，任务 ID:&quot;</span><span class="p">,</span> <span class="n">job</span><span class="o">.</span><span class="n">job_id</span><span class="p">())</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">job_status</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="n">status</span><span class="p">()</span>
        <span class="c1"># 如果任务完成，获取结果</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">job</span><span class="o">.</span><span class="n">running</span><span class="p">():</span>
            <span class="k">break</span>
    <span class="k">return</span> <span class="n">job</span>

<span class="k">def</span><span class="w"> </span><span class="nf">QPE</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">backend</span><span class="p">):</span>

    <span class="n">qc</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="n">QUBIT</span> <span class="o">+</span> <span class="n">N_COUNT</span><span class="p">,</span> <span class="n">N_COUNT</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_COUNT</span><span class="p">):</span>
        <span class="n">qc</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>  <span class="c1"># Initialize counting qubits in state |+&gt;</span>
    <span class="n">qc</span><span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="n">N_COUNT</span><span class="p">)</span>  <span class="c1"># And auxiliary register in state |1&gt;</span>
    <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_COUNT</span><span class="p">):</span>  <span class="c1"># Do controlled-U operations</span>
        <span class="n">qc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">U_a</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">q</span><span class="p">),</span>
                  <span class="p">[</span><span class="n">q</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">N_COUNT</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">QUBIT</span><span class="p">)])</span>
    <span class="n">qc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">QFT</span><span class="p">(</span><span class="n">N_COUNT</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_COUNT</span><span class="p">))</span>  <span class="c1"># Do inverse-QFT</span>
    <span class="n">qc</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">N_COUNT</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_COUNT</span><span class="p">))</span>
    <span class="c1"># Simulate Results</span>
    <span class="c1"># job = simulate(qc)</span>
    <span class="n">job</span> <span class="o">=</span> <span class="n">run</span><span class="p">(</span><span class="n">qc</span><span class="p">,</span> <span class="n">backend</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">get_phase</span><span class="p">(</span><span class="n">job</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">Shor</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">backend</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">FACTOR_FOUND</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">ATTEMPT</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="ow">not</span> <span class="n">FACTOR_FOUND</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">a</span> <span class="o">%</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">gcd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">ATTEMPT</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">ATTEMPT </span><span class="si">{</span><span class="n">ATTEMPT</span><span class="si">}</span><span class="s2">: a = </span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">phase</span> <span class="o">=</span> <span class="n">QPE</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">backend</span><span class="p">)</span>  <span class="c1"># Phase = s/r</span>
        <span class="n">frac</span> <span class="o">=</span> <span class="n">Fraction</span><span class="p">(</span><span class="n">phase</span><span class="p">)</span><span class="o">.</span><span class="n">limit_denominator</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">frac</span><span class="o">.</span><span class="n">denominator</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Result: r = </span><span class="si">{</span><span class="n">r</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">phase</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># Guesses for factors are gcd(x^{r/2} ±1 , 15)</span>
            <span class="n">guesses</span> <span class="o">=</span> <span class="p">[</span><span class="n">gcd</span><span class="p">(</span><span class="n">a</span> <span class="o">**</span> <span class="p">(</span><span class="n">r</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">),</span> <span class="n">gcd</span><span class="p">(</span><span class="n">a</span> <span class="o">**</span> <span class="p">(</span><span class="n">r</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">)]</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Guessed Factors: </span><span class="si">{</span><span class="n">guesses</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="n">guesses</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">guess</span> <span class="ow">in</span> <span class="n">guesses</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">guess</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">]</span> <span class="ow">and</span> <span class="p">(</span><span class="n">N</span> <span class="o">%</span> <span class="n">guess</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="c1"># Guess is a factor!</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;*** Non-trivial factor found: </span><span class="si">{</span><span class="n">guess</span><span class="si">}</span><span class="s2"> ***&quot;</span><span class="p">)</span>
                    <span class="n">FACTOR_FOUND</span> <span class="o">=</span> <span class="kc">True</span>


<span class="k">def</span><span class="w"> </span><span class="nf">account</span><span class="p">():</span>
    <span class="n">QiskitRuntimeService</span><span class="o">.</span><span class="n">save_account</span><span class="p">(</span><span class="n">channel</span><span class="o">=</span><span class="s2">&quot;ibm_quantum&quot;</span><span class="p">,</span> 
        <span class="n">token</span><span class="o">=</span><span class="n">api_token</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">set_as_default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">service</span> <span class="o">=</span> <span class="n">QiskitRuntimeService</span><span class="p">(</span><span class="n">channel</span><span class="o">=</span><span class="s2">&quot;ibm_quantum&quot;</span><span class="p">)</span>
    <span class="n">backend</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">least_busy</span><span class="p">(</span><span class="n">operational</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">simulator</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">min_num_qubits</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">backend</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">backend</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">backend</span> <span class="o">=</span> <span class="n">account</span><span class="p">()</span>
    <span class="n">Shor</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="n">backend</span><span class="p">)</span>
</code></pre></div>
<h2 id="_19">实验结果</h2>
<h3 id="_20">仿真运行结果</h3>
<p>仿真的运行结果如下:</p>
<div class="highlight"><pre><span></span><code><span class="n">ATTEMPT</span> <span class="mi">1</span><span class="p">:</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">2</span>
<span class="p">[(</span><span class="s1">&#39;00000000&#39;</span><span class="p">,</span> <span class="mi">268</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11000000&#39;</span><span class="p">,</span> <span class="mi">257</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01000000&#39;</span><span class="p">,</span> <span class="mi">257</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10000000&#39;</span><span class="p">,</span> <span class="mi">242</span><span class="p">)]</span>
<span class="n">Register</span> <span class="n">Reading</span><span class="p">:</span> <span class="mi">00000000</span>
<span class="n">Corresponding</span> <span class="n">Phase</span><span class="p">:</span> <span class="mf">0.0</span>
<span class="n">Result</span><span class="p">:</span> <span class="n">r</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">ATTEMPT</span> <span class="mi">2</span><span class="p">:</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">4</span>
<span class="p">[(</span><span class="s1">&#39;00000000&#39;</span><span class="p">,</span> <span class="mi">522</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10000000&#39;</span><span class="p">,</span> <span class="mi">502</span><span class="p">)]</span>
<span class="n">Register</span> <span class="n">Reading</span><span class="p">:</span> <span class="mi">00000000</span>
<span class="n">Corresponding</span> <span class="n">Phase</span><span class="p">:</span> <span class="mf">0.0</span>
<span class="n">Result</span><span class="p">:</span> <span class="n">r</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">ATTEMPT</span> <span class="mi">3</span><span class="p">:</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">7</span>
<span class="p">[(</span><span class="s1">&#39;01000000&#39;</span><span class="p">,</span> <span class="mi">273</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11000000&#39;</span><span class="p">,</span> <span class="mi">269</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10000000&#39;</span><span class="p">,</span> <span class="mi">249</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00000000&#39;</span><span class="p">,</span> <span class="mi">233</span><span class="p">)]</span>
<span class="n">Register</span> <span class="n">Reading</span><span class="p">:</span> <span class="mi">01000000</span>
<span class="n">Corresponding</span> <span class="n">Phase</span><span class="p">:</span> <span class="mf">0.25</span>
<span class="n">Result</span><span class="p">:</span> <span class="n">r</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">Guessed</span> <span class="n">Factors</span><span class="p">:</span> <span class="mi">3</span> <span class="ow">and</span> <span class="mi">5</span>
<span class="o">***</span> <span class="n">Non</span><span class="o">-</span><span class="n">trivial</span> <span class="n">factor</span> <span class="n">found</span><span class="p">:</span> <span class="mi">3</span> <span class="o">***</span>
<span class="o">***</span> <span class="n">Non</span><span class="o">-</span><span class="n">trivial</span> <span class="n">factor</span> <span class="n">found</span><span class="p">:</span> <span class="mi">5</span> <span class="o">***</span>
</code></pre></div>
<p>从结果可以看到，第一次选择的模指的 <span class="arithmatex">\(a=2\)</span>, 即底数 <span class="arithmatex">\(y=2\)</span> </p>
<p>此时测得相位 <span class="arithmatex">\(\phi = 0\)</span>, 无法得到 <span class="arithmatex">\(r\)</span>，因此更换 <span class="arithmatex">\(y\)</span></p>
<p>第二次 <span class="arithmatex">\(y=4\)</span> 依然得不到结果，更换 <span class="arithmatex">\(y=7\)</span></p>
<p>此时测得相位 <span class="arithmatex">\(\phi = \frac14\)</span>, 得到 <span class="arithmatex">\(r=4\)</span></p>
<p>由于 <span class="arithmatex">\(\gcd(y^{r/2}+1,N)=5,\gcd(y^{r/2}-1,N)=3\)</span>, 所以已经得到了两个素数因子，算法结束，结果符合预期</p>
<p>另一次测量结果如下：</p>
<div class="highlight"><pre><span></span><code><span class="n">ATTEMPT</span> <span class="mi">1</span><span class="p">:</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">2</span>
<span class="p">[(</span><span class="s1">&#39;01000000&#39;</span><span class="p">,</span> <span class="mi">263</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11000000&#39;</span><span class="p">,</span> <span class="mi">262</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10000000&#39;</span><span class="p">,</span> <span class="mi">250</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00000000&#39;</span><span class="p">,</span> <span class="mi">249</span><span class="p">)]</span>
<span class="n">Register</span> <span class="n">Reading</span><span class="p">:</span> <span class="mi">01000000</span>
<span class="n">Corresponding</span> <span class="n">Phase</span><span class="p">:</span> <span class="mf">0.25</span>
<span class="n">Result</span><span class="p">:</span> <span class="n">r</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">Guessed</span> <span class="n">Factors</span><span class="p">:</span> <span class="mi">3</span> <span class="ow">and</span> <span class="mi">5</span>
<span class="o">***</span> <span class="n">Non</span><span class="o">-</span><span class="n">trivial</span> <span class="n">factor</span> <span class="n">found</span><span class="p">:</span> <span class="mi">3</span> <span class="o">***</span>
<span class="o">***</span> <span class="n">Non</span><span class="o">-</span><span class="n">trivial</span> <span class="n">factor</span> <span class="n">found</span><span class="p">:</span> <span class="mi">5</span> <span class="o">***</span>
</code></pre></div>
<p>可以看到，这次测量中 <span class="arithmatex">\(a=2\)</span> 算出了正确周期 <span class="arithmatex">\(r=4\)</span>, 直接得到了因子 <span class="arithmatex">\(3\)</span> 和 <span class="arithmatex">\(5\)</span></p>
<h3 id="_21">真机运行结果</h3>
<p>提交到真机后运行结果如下：</p>
<p><img alt="alt text" src="../../images/quantum_pic/image-10.png" /></p>
<p><img alt="alt text" src="../../images/quantum_pic/image-9.png" /></p>
<div class="highlight"><pre><span></span><code><span class="n">ibm_brisbane</span>

<span class="n">ATTEMPT</span> <span class="mi">1</span><span class="p">:</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">任务已提交</span><span class="err">，</span><span class="n">任务</span> <span class="n">ID</span><span class="p">:</span> <span class="n">cwyqh74tdtng0087r2v0</span>
<span class="p">[(</span><span class="s1">&#39;00010100&#39;</span><span class="p">,</span> <span class="mi">36</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00000110&#39;</span><span class="p">,</span> <span class="mi">36</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00100110&#39;</span><span class="p">,</span> <span class="mi">34</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00011100&#39;</span><span class="p">,</span> <span class="mi">34</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;00011110&#39;</span><span class="p">,</span> <span class="mi">33</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01000100&#39;</span><span class="p">,</span> <span class="mi">32</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00001010&#39;</span><span class="p">,</span> <span class="mi">31</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00000111&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;01111101&#39;</span><span class="p">,</span> <span class="mi">29</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00110001&#39;</span><span class="p">,</span> <span class="mi">29</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00001100&#39;</span><span class="p">,</span> <span class="mi">29</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00000010&#39;</span><span class="p">,</span> <span class="mi">28</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;00010110&#39;</span><span class="p">,</span> <span class="mi">28</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01011000&#39;</span><span class="p">,</span> <span class="mi">28</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11010100&#39;</span><span class="p">,</span> <span class="mi">28</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00011101&#39;</span><span class="p">,</span> <span class="mi">27</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;00000011&#39;</span><span class="p">,</span> <span class="mi">27</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00111001&#39;</span><span class="p">,</span> <span class="mi">27</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00111101&#39;</span><span class="p">,</span> <span class="mi">27</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00111110&#39;</span><span class="p">,</span> <span class="mi">27</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;01011100&#39;</span><span class="p">,</span> <span class="mi">26</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00100001&#39;</span><span class="p">,</span> <span class="mi">26</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00001000&#39;</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01000110&#39;</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;00010101&#39;</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01001110&#39;</span><span class="p">,</span> <span class="mi">24</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11111101&#39;</span><span class="p">,</span> <span class="mi">24</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11111010&#39;</span><span class="p">,</span> <span class="mi">24</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;00010000&#39;</span><span class="p">,</span> <span class="mi">24</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00010010&#39;</span><span class="p">,</span> <span class="mi">24</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00001110&#39;</span><span class="p">,</span> <span class="mi">24</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01001000&#39;</span><span class="p">,</span> <span class="mi">24</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;00101111&#39;</span><span class="p">,</span> <span class="mi">24</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11110111&#39;</span><span class="p">,</span> <span class="mi">24</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00010001&#39;</span><span class="p">,</span> <span class="mi">24</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00101001&#39;</span><span class="p">,</span> <span class="mi">24</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;01011110&#39;</span><span class="p">,</span> <span class="mi">24</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11101010&#39;</span><span class="p">,</span> <span class="mi">23</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00100011&#39;</span><span class="p">,</span> <span class="mi">23</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01010000&#39;</span><span class="p">,</span> <span class="mi">23</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;01001010&#39;</span><span class="p">,</span> <span class="mi">23</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11001010&#39;</span><span class="p">,</span> <span class="mi">23</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00101010&#39;</span><span class="p">,</span> <span class="mi">23</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00011000&#39;</span><span class="p">,</span> <span class="mi">22</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;00101011&#39;</span><span class="p">,</span> <span class="mi">22</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11111111&#39;</span><span class="p">,</span> <span class="mi">22</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11110110&#39;</span><span class="p">,</span> <span class="mi">22</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00001111&#39;</span><span class="p">,</span> <span class="mi">22</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;00110101&#39;</span><span class="p">,</span> <span class="mi">22</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00111000&#39;</span><span class="p">,</span> <span class="mi">22</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11000100&#39;</span><span class="p">,</span> <span class="mi">22</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11111011&#39;</span><span class="p">,</span> <span class="mi">22</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;11011101&#39;</span><span class="p">,</span> <span class="mi">22</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00100101&#39;</span><span class="p">,</span> <span class="mi">22</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00011111&#39;</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01101011&#39;</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;01001111&#39;</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01000111&#39;</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01001101&#39;</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00011001&#39;</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;00000000&#39;</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01110101&#39;</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11011000&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00001011&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;11101101&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01001100&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01010110&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00110011&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;11110101&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01000011&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00111111&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01011101&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;00101100&#39;</span><span class="p">,</span> <span class="mi">19</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00100111&#39;</span><span class="p">,</span> <span class="mi">19</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00101101&#39;</span><span class="p">,</span> <span class="mi">19</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00000100&#39;</span><span class="p">,</span> <span class="mi">19</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;00100000&#39;</span><span class="p">,</span> <span class="mi">19</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01111110&#39;</span><span class="p">,</span> <span class="mi">19</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11010110&#39;</span><span class="p">,</span> <span class="mi">19</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01100010&#39;</span><span class="p">,</span> <span class="mi">19</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;00010111&#39;</span><span class="p">,</span> <span class="mi">19</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00110010&#39;</span><span class="p">,</span> <span class="mi">19</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10010000&#39;</span><span class="p">,</span> <span class="mi">18</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11011100&#39;</span><span class="p">,</span> <span class="mi">18</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;11110011&#39;</span><span class="p">,</span> <span class="mi">18</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00000001&#39;</span><span class="p">,</span> <span class="mi">18</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00101110&#39;</span><span class="p">,</span> <span class="mi">18</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00100100&#39;</span><span class="p">,</span> <span class="mi">18</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;00011011&#39;</span><span class="p">,</span> <span class="mi">18</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01100111&#39;</span><span class="p">,</span> <span class="mi">18</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00110000&#39;</span><span class="p">,</span> <span class="mi">18</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11011010&#39;</span><span class="p">,</span> <span class="mi">18</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;10110011&#39;</span><span class="p">,</span> <span class="mi">17</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01010101&#39;</span><span class="p">,</span> <span class="mi">17</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11111110&#39;</span><span class="p">,</span> <span class="mi">17</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01000010&#39;</span><span class="p">,</span> <span class="mi">17</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;10110101&#39;</span><span class="p">,</span> <span class="mi">17</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00101000&#39;</span><span class="p">,</span> <span class="mi">17</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01110001&#39;</span><span class="p">,</span> <span class="mi">17</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10011110&#39;</span><span class="p">,</span> <span class="mi">17</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;11101011&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11101111&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11110100&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01011001&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;10010100&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01111100&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11001110&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11010001&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;11110001&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11010000&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00110110&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00110111&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;00011010&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10101011&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11101110&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11000010&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;01111001&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11100110&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00111100&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01011010&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;01100001&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11111100&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10111100&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01010010&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;01010011&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11100100&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00110100&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00111011&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;01000000&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00111010&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11111001&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01110110&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;11001100&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01101110&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11110000&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01111000&#39;</span><span class="p">,</span> <span class="mi">14</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;01101111&#39;</span><span class="p">,</span> <span class="mi">14</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11000110&#39;</span><span class="p">,</span> <span class="mi">14</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00010011&#39;</span><span class="p">,</span> <span class="mi">14</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10010111&#39;</span><span class="p">,</span> <span class="mi">14</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;11010010&#39;</span><span class="p">,</span> <span class="mi">14</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10100011&#39;</span><span class="p">,</span> <span class="mi">14</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10011100&#39;</span><span class="p">,</span> <span class="mi">14</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10010110&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;11010101&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01100011&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10000111&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11011001&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;11100111&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10111101&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01111111&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11011110&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;10110001&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01110011&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01000001&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11101001&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;10011001&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10000110&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10000000&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11110010&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;11011111&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01010100&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10111001&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11001101&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span>
<span class="p">(</span><span class="s1">&#39;10101101&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11001111&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00000101&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01011111&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;01110111&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11100010&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01101100&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10111010&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;11101000&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11101100&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11000000&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10111110&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;10111011&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10001100&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10111111&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11010111&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;01001011&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10101110&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10100000&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10001000&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;10001011&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01110100&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10011010&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10001010&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;01000101&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01100000&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11011011&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10000101&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;01101101&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00001101&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01110000&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01010001&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;00001001&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01100110&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11100000&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10110100&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;10000011&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10000010&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01001001&#39;</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10110010&#39;</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;10010010&#39;</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10011101&#39;</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01011011&#39;</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11000111&#39;</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;01100100&#39;</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10100100&#39;</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10110111&#39;</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00100010&#39;</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;11000011&#39;</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11100001&#39;</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11111000&#39;</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10001111&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;01010111&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11001000&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10100010&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01110010&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;01101010&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11010011&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10101010&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10011000&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;01111010&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10010101&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10110110&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11001001&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;11100011&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10100001&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10101111&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10011011&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;10111000&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11100101&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10011111&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01100101&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;10001101&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10010001&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10100111&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01111011&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;01101001&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10101000&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10110000&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10001110&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;10001001&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10101001&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10100110&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10010011&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;10000100&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10000001&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10101100&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11001011&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;01101000&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11000101&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11000001&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10100101&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>
<span class="n">Register</span> <span class="n">Reading</span><span class="p">:</span> <span class="mi">00010100</span>
<span class="n">Corresponding</span> <span class="n">Phase</span><span class="p">:</span> <span class="mf">0.078125</span>
<span class="n">Result</span><span class="p">:</span> <span class="n">r</span> <span class="o">=</span> <span class="mi">13</span>
<span class="n">Guessed</span> <span class="n">Factors</span><span class="p">:</span> <span class="mi">3</span> <span class="ow">and</span> <span class="mi">5</span>
<span class="o">***</span> <span class="n">Non</span><span class="o">-</span><span class="n">trivial</span> <span class="n">factor</span> <span class="n">found</span><span class="p">:</span> <span class="mi">3</span> <span class="o">***</span>
<span class="o">***</span> <span class="n">Non</span><span class="o">-</span><span class="n">trivial</span> <span class="n">factor</span> <span class="n">found</span><span class="p">:</span> <span class="mi">5</span> <span class="o">***</span>
</code></pre></div>
<p>可以看到，这次测量得到了错误的周期 <span class="arithmatex">\(r=13\)</span>, 但是最后也得到了正确答案 <span class="arithmatex">\(3,5\)</span></p>
<p>这说明真机上误差较大，容易计算出错误的周期</p>
<p>另外一次测量结果如下:</p>
<p><img alt="" src="../../images/image_18.png" />
<img alt="" src="../../images/image_19.png" />
<div class="highlight"><pre><span></span><code><span class="n">ibm_kyiv</span>

<span class="n">ATTEMPT</span> <span class="mi">1</span><span class="p">:</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">任务已提交</span><span class="err">，</span><span class="n">任务</span> <span class="n">ID</span><span class="p">:</span> <span class="n">cxk8f3mfdnwg008sqdh0</span>
<span class="p">[(</span><span class="s1">&#39;11000000&#39;</span><span class="p">,</span> <span class="mi">35</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10110110&#39;</span><span class="p">,</span> <span class="mi">33</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11000011&#39;</span><span class="p">,</span> <span class="mi">31</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10111110&#39;</span><span class="p">,</span> <span class="mi">31</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;10100000&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11101011&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11000101&#39;</span><span class="p">,</span> <span class="mi">29</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10101001&#39;</span><span class="p">,</span> <span class="mi">28</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;11100111&#39;</span><span class="p">,</span> <span class="mi">28</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10101000&#39;</span><span class="p">,</span> <span class="mi">27</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10111000&#39;</span><span class="p">,</span> <span class="mi">27</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10100001&#39;</span><span class="p">,</span> <span class="mi">27</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;10110001&#39;</span><span class="p">,</span> <span class="mi">27</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10110100&#39;</span><span class="p">,</span> <span class="mi">27</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11001110&#39;</span><span class="p">,</span> <span class="mi">27</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10100010&#39;</span><span class="p">,</span> <span class="mi">27</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;10000100&#39;</span><span class="p">,</span> <span class="mi">26</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11100011&#39;</span><span class="p">,</span> <span class="mi">26</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11100101&#39;</span><span class="p">,</span> <span class="mi">26</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10101101&#39;</span><span class="p">,</span> <span class="mi">26</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;11001001&#39;</span><span class="p">,</span> <span class="mi">26</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11010100&#39;</span><span class="p">,</span> <span class="mi">26</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10100111&#39;</span><span class="p">,</span> <span class="mi">26</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10100100&#39;</span><span class="p">,</span> <span class="mi">26</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;11101001&#39;</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11000010&#39;</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10100110&#39;</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10010101&#39;</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;11110100&#39;</span><span class="p">,</span> <span class="mi">24</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11010011&#39;</span><span class="p">,</span> <span class="mi">24</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11001000&#39;</span><span class="p">,</span> <span class="mi">24</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00001001&#39;</span><span class="p">,</span> <span class="mi">24</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;11110010&#39;</span><span class="p">,</span> <span class="mi">24</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10000111&#39;</span><span class="p">,</span> <span class="mi">24</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10101010&#39;</span><span class="p">,</span> <span class="mi">24</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10000001&#39;</span><span class="p">,</span> <span class="mi">24</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;11100001&#39;</span><span class="p">,</span> <span class="mi">24</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10111100&#39;</span><span class="p">,</span> <span class="mi">23</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10110101&#39;</span><span class="p">,</span> <span class="mi">23</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11010101&#39;</span><span class="p">,</span> <span class="mi">23</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;11100110&#39;</span><span class="p">,</span> <span class="mi">23</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10110010&#39;</span><span class="p">,</span> <span class="mi">22</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00001010&#39;</span><span class="p">,</span> <span class="mi">22</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11101101&#39;</span><span class="p">,</span> <span class="mi">22</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;10011000&#39;</span><span class="p">,</span> <span class="mi">22</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10101100&#39;</span><span class="p">,</span> <span class="mi">22</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10000110&#39;</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11100010&#39;</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;11000001&#39;</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00000010&#39;</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10101110&#39;</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01110110&#39;</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;10101111&#39;</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11001010&#39;</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11011011&#39;</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10100011&#39;</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;11010001&#39;</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10110011&#39;</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10101011&#39;</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10111011&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;10111001&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01100001&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01111000&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00001000&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;00100010&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11000100&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10111111&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10010100&#39;</span><span class="p">,</span> <span class="mi">19</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;01010100&#39;</span><span class="p">,</span> <span class="mi">19</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10111010&#39;</span><span class="p">,</span> <span class="mi">19</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01101011&#39;</span><span class="p">,</span> <span class="mi">19</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11101111&#39;</span><span class="p">,</span> <span class="mi">19</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;10010011&#39;</span><span class="p">,</span> <span class="mi">19</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00100001&#39;</span><span class="p">,</span> <span class="mi">19</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11110101&#39;</span><span class="p">,</span> <span class="mi">19</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11001011&#39;</span><span class="p">,</span> <span class="mi">18</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;10011100&#39;</span><span class="p">,</span> <span class="mi">18</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11011001&#39;</span><span class="p">,</span> <span class="mi">18</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10001000&#39;</span><span class="p">,</span> <span class="mi">18</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10011101&#39;</span><span class="p">,</span> <span class="mi">18</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;11000110&#39;</span><span class="p">,</span> <span class="mi">18</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10000000&#39;</span><span class="p">,</span> <span class="mi">18</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11011100&#39;</span><span class="p">,</span> <span class="mi">18</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10111101&#39;</span><span class="p">,</span> <span class="mi">18</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;11000111&#39;</span><span class="p">,</span> <span class="mi">18</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10001010&#39;</span><span class="p">,</span> <span class="mi">18</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10011111&#39;</span><span class="p">,</span> <span class="mi">17</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10011010&#39;</span><span class="p">,</span> <span class="mi">17</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;11010010&#39;</span><span class="p">,</span> <span class="mi">17</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00101111&#39;</span><span class="p">,</span> <span class="mi">17</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11011010&#39;</span><span class="p">,</span> <span class="mi">17</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11110111&#39;</span><span class="p">,</span> <span class="mi">17</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;01100100&#39;</span><span class="p">,</span> <span class="mi">17</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11001111&#39;</span><span class="p">,</span> <span class="mi">17</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01100110&#39;</span><span class="p">,</span> <span class="mi">17</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11101000&#39;</span><span class="p">,</span> <span class="mi">17</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;01001110&#39;</span><span class="p">,</span> <span class="mi">17</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10001110&#39;</span><span class="p">,</span> <span class="mi">17</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10001111&#39;</span><span class="p">,</span> <span class="mi">17</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11100000&#39;</span><span class="p">,</span> <span class="mi">17</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;00100111&#39;</span><span class="p">,</span> <span class="mi">17</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01110100&#39;</span><span class="p">,</span> <span class="mi">17</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01001111&#39;</span><span class="p">,</span> <span class="mi">17</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10000011&#39;</span><span class="p">,</span> <span class="mi">17</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;00100110&#39;</span><span class="p">,</span> <span class="mi">17</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10000101&#39;</span><span class="p">,</span> <span class="mi">17</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10010010&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10011011&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;11010000&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10010000&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10011110&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01100101&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;11111111&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00100100&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01111110&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10110111&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;11011111&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01111101&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11011101&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11101110&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;11011110&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00000000&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01111001&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01110000&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;10001011&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00100000&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00101110&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11001100&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;10001100&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00100011&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00101100&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10110000&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;01100111&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01101101&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11011000&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10010110&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;00101011&#39;</span><span class="p">,</span> <span class="mi">14</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00000111&#39;</span><span class="p">,</span> <span class="mi">14</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11110011&#39;</span><span class="p">,</span> <span class="mi">14</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01110010&#39;</span><span class="p">,</span> <span class="mi">14</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;11111000&#39;</span><span class="p">,</span> <span class="mi">14</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10001001&#39;</span><span class="p">,</span> <span class="mi">14</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00101000&#39;</span><span class="p">,</span> <span class="mi">14</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00000110&#39;</span><span class="p">,</span> <span class="mi">14</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;00000011&#39;</span><span class="p">,</span> <span class="mi">14</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11111010&#39;</span><span class="p">,</span> <span class="mi">14</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01011001&#39;</span><span class="p">,</span> <span class="mi">14</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10010111&#39;</span><span class="p">,</span> <span class="mi">14</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;10011001&#39;</span><span class="p">,</span> <span class="mi">14</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01101111&#39;</span><span class="p">,</span> <span class="mi">14</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01001101&#39;</span><span class="p">,</span> <span class="mi">14</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00010101&#39;</span><span class="p">,</span> <span class="mi">14</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;11110000&#39;</span><span class="p">,</span> <span class="mi">14</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01111011&#39;</span><span class="p">,</span> <span class="mi">14</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01111010&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00011111&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;10100101&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01101110&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01000101&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11111100&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;00001100&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00000101&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01000011&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11110001&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;00100101&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01001010&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01101100&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01000110&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;01011111&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01001100&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00001101&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11100100&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;10010001&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11101100&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11001101&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01100000&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;01101001&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11101010&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01100010&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00101001&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;11111101&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01110111&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00000100&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11110110&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;01110001&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00010000&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01000111&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10000010&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;01010101&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01110101&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;10001101&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11111011&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;01011101&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01000010&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01010001&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11010110&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;01111100&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00001111&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01101000&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11010111&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;00010001&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01001000&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01010111&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11111001&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;00000001&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01000000&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00110111&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;11111110&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;00010010&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00111110&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01001001&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00001110&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;00011100&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00111011&#39;</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01011100&#39;</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01101010&#39;</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;00111100&#39;</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01011110&#39;</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01100011&#39;</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01111111&#39;</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;01000100&#39;</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00011101&#39;</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00111101&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01010110&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;00110001&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00101010&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00110101&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00101101&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;01001011&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00110100&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01010011&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01010000&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;01110011&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00011110&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00011000&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00010110&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;00010111&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01011010&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00010100&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00110110&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;00011001&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00111111&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00110010&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00011010&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;00111000&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00110011&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01011000&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01000001&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;00110000&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00001011&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00111010&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;01011011&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> 
<span class="p">(</span><span class="s1">&#39;01010010&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00011011&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00010011&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;00111001&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]</span>
<span class="n">Register</span> <span class="n">Reading</span><span class="p">:</span> <span class="mi">11000000</span>
<span class="n">Corresponding</span> <span class="n">Phase</span><span class="p">:</span> <span class="mf">0.75</span>
<span class="n">Result</span><span class="p">:</span> <span class="n">r</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">Guessed</span> <span class="n">Factors</span><span class="p">:</span> <span class="mi">3</span> <span class="ow">and</span> <span class="mi">5</span>
<span class="o">***</span> <span class="n">Non</span><span class="o">-</span><span class="n">trivial</span> <span class="n">factor</span> <span class="n">found</span><span class="p">:</span> <span class="mi">3</span> <span class="o">***</span>
<span class="o">***</span> <span class="n">Non</span><span class="o">-</span><span class="n">trivial</span> <span class="n">factor</span> <span class="n">found</span><span class="p">:</span> <span class="mi">5</span> <span class="o">***</span>
</code></pre></div></p>
<p>可以看到, 这次运行结果在 <code>11000000</code> 这个状态处得到了最大频率</p>
<p>于是得到了正确的周期 <span class="arithmatex">\(r=4\)</span>, 并求出了两个因子 <span class="arithmatex">\(3,5\)</span></p>
<h1 id="_22">未来展望</h1>
<ul>
<li><span class="arithmatex">\(RSA\)</span> 安全性</li>
<li>
<p><span class="arithmatex">\(BQP\)</span> 与 <span class="arithmatex">\(NPC\)</span></p>
<p>我们已知 <code>Shor</code> 算法即属于 <span class="arithmatex">\(BQP\)</span>, 又属于 <span class="arithmatex">\(NP\)</span>, 但我们不知道它是否属于 <span class="arithmatex">\(NPC\)</span></p>
<p>目前为止并没有证据表明 <span class="arithmatex">\(NPC\)</span> 与 <span class="arithmatex">\(BQP\)</span> 之间的关系</p>
<p>但是假如我们发现了一个 <span class="arithmatex">\(NPC\)</span> 问题一定不属于 <span class="arithmatex">\(BQP\)</span>, 那么由于 <span class="arithmatex">\(P\subseteq BQP\)</span>, 就可以有<span class="arithmatex">\(P\not=NPC\)</span>, 进而 <span class="arithmatex">\(P\not=NP\)</span></p>
</li>
</ul>
<h1 id="_23">参考文献</h1>
<p>[1]:  <a href="https://arxiv.org/pdf/quant-ph/9508027">P. Shor (1997), <em>Polynomial-time algorithms for prime factorization
and discrete logarithms on a quantum computer</em>, SIAM J. Comp., 26,
pp. 1484-1509. Also on quant-ph/9508027</a></p>
<p>[2]: <a href="https://arxiv.org/pdf/quant-ph/0205095">St´ephane Beauregard, <em>Circuit for Shor’s algorithm using 2n+3 qubits</em>. Also on quant-ph/0205095
</a></p>
<p>[3]: <a href="https://www.nature.com/articles/s41598-021-95973-w#citeas">Unathi Skosana and MarkTame, <em>Demonstration of Shor’s factoring algorithm for N = 21 on IBM quantum processors</em>, Scientific Reports volume 11, Article number: 16599 (2021)</a></p>
<p>[4]: <a href="https://github.com/Qiskit/textbook/blob/aebdd2bc86ddb7a79dd8441d52c839d312ffafbb/notebooks/ch-algorithms/quantum-fourier-transform.ipynb"><em>Qiskit textbook: quantum-fourier-transform</em>. Also on Github</a></p>
<p>[5]: <a href="https://github.com/Qiskit/textbook/blob/aebdd2bc86ddb7a79dd8441d52c839d312ffafbb/notebooks/ch-algorithms/shor.ipynb"><em>Qiskit textbook: shor</em>. Also on Github</a></p>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2025 - 2077 AKonjac_
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.60a45f97.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>