
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../Schr%C3%B6dinger%20equation/">
      
      
        <link rel="next" href="../../misc/CTF/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.50">
    
    
      
        <title>quantum computation - My Docs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.a40c8224.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="https://unpkg.com/katex@0/dist/katex.min.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="My Docs" class="md-header__button md-logo" aria-label="My Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            My Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              quantum computation
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="blue"  aria-label="切换到暗色模式"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="切换到暗色模式" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="deep-purple" data-md-color-accent="purple"  aria-label="切换到亮色模式"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="切换到亮色模式" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/akonjac0/note" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    Ako's Note
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../about/" class="md-tabs__link">
        
  
    
  
  About

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../ADS/BPlusTree/" class="md-tabs__link">
          
  
  ADS

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../CO/computer%20organization%20and%20design/" class="md-tabs__link">
          
  
  CO

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../General%20Pyhsics%20II/" class="md-tabs__link">
          
  
  General physics

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../misc/CTF/" class="md-tabs__link">
          
  
  Misc

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../probability/martingale%20and%20stopping%20times/" class="md-tabs__link">
          
  
  Probability

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../x86asm/ASM/" class="md-tabs__link">
          
  
  X86asm

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="My Docs" class="md-nav__button md-logo" aria-label="My Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    My Docs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/akonjac0/note" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    Ako's Note
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ADS
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            ADS
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ADS/BPlusTree/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BPlusTree
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ADS/Binomial%20Queue/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Binomial Queue
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ADS/Galois%20Field/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Galois Field
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ADS/IFI/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IFI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ADS/Master%20Theorem/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Master Theorem
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ADS/Misra-Gries/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Misra-Gries
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ADS/NPC%20and%20Approximation%20and%20Local%20Search/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NPC and Approximation and Local Search
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ADS/SkipList/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Skip List
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ADS/WBLT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    WBLT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ADS/amortized%20analysis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    amortized analysis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ADS/binet%20cauchy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Binet-Cauchy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ADS/cardinality%20of%20sets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cardinality of sets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ADS/computation%20problem/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    computation problem
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ADS/convex/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    convex
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ADS/error%20correction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    error correction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ADS/external%20sorting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    external sorting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ADS/group%20theory/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    group theory
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ADS/linear%20programming/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    linear programming
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ADS/parallel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    parallel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ADS/randomized/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    randomized
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ADS/red%20black%20tree/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    red black tree
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ADS/scapegoat%20tree/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    scapegoat
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ADS/searching/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    searching
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ADS/skew%20heap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    skew heap
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ADS/splay/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    splay
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    CO
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            CO
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CO/computer%20organization%20and%20design/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    computer organization and design
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  <span class="md-ellipsis">
    General physics
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            General physics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../General%20Pyhsics%20II/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    General Pyhsics II
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Schr%C3%B6dinger%20equation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Schrödinger equation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    quantum computation
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    quantum computation
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      前置
    </span>
  </a>
  
    <nav class="md-nav" aria-label="前置">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      狄拉克符号
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      张量积
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      相对黑盒
    </span>
  </a>
  
    <nav class="md-nav" aria-label="相对黑盒">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      介绍
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#u_f" class="md-nav__link">
    <span class="md-ellipsis">
      \(U_f\)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      算法
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#grover" class="md-nav__link">
    <span class="md-ellipsis">
      Grover
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#shor" class="md-nav__link">
    <span class="md-ellipsis">
      Shor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Shor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      量子傅里叶变换
    </span>
  </a>
  
    <nav class="md-nav" aria-label="量子傅里叶变换">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dft" class="md-nav__link">
    <span class="md-ellipsis">
      DFT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qft" class="md-nav__link">
    <span class="md-ellipsis">
      QFT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qft_1" class="md-nav__link">
    <span class="md-ellipsis">
      整理 QFT 得出量子电路易实现的形式
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      电路实现
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      模指
    </span>
  </a>
  
    <nav class="md-nav" aria-label="模指">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      量子加法器
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      量子模加器
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      量子可控模乘器
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      模指模块
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qpe" class="md-nav__link">
    <span class="md-ellipsis">
      量子相位估计 QPE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shor_1" class="md-nav__link">
    <span class="md-ellipsis">
      Shor 算法
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Shor 算法">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      约化素数因子分解
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fxaxmod-n" class="md-nav__link">
    <span class="md-ellipsis">
      求解 \(f(x)=a^x\mod N\) 的周期
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    <span class="md-ellipsis">
      电路实现
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Misc
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Misc
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../misc/CTF/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CTF-WriteUp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../misc/bangumi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bangumi
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../misc/sovits/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    so-vits-svc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../misc/why%20r%20ur%20head%20sharp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    why r ur head sharp
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Probability
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Probability
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../probability/martingale%20and%20stopping%20times/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    martingale and stopping times
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../probability/probability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    probability
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    X86asm
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            X86asm
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../x86asm/ASM/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    asm
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      前置
    </span>
  </a>
  
    <nav class="md-nav" aria-label="前置">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      狄拉克符号
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      张量积
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      相对黑盒
    </span>
  </a>
  
    <nav class="md-nav" aria-label="相对黑盒">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      介绍
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#u_f" class="md-nav__link">
    <span class="md-ellipsis">
      \(U_f\)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      算法
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#grover" class="md-nav__link">
    <span class="md-ellipsis">
      Grover
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#shor" class="md-nav__link">
    <span class="md-ellipsis">
      Shor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Shor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      量子傅里叶变换
    </span>
  </a>
  
    <nav class="md-nav" aria-label="量子傅里叶变换">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dft" class="md-nav__link">
    <span class="md-ellipsis">
      DFT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qft" class="md-nav__link">
    <span class="md-ellipsis">
      QFT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qft_1" class="md-nav__link">
    <span class="md-ellipsis">
      整理 QFT 得出量子电路易实现的形式
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      电路实现
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      模指
    </span>
  </a>
  
    <nav class="md-nav" aria-label="模指">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      量子加法器
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      量子模加器
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      量子可控模乘器
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      模指模块
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qpe" class="md-nav__link">
    <span class="md-ellipsis">
      量子相位估计 QPE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shor_1" class="md-nav__link">
    <span class="md-ellipsis">
      Shor 算法
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Shor 算法">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      约化素数因子分解
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fxaxmod-n" class="md-nav__link">
    <span class="md-ellipsis">
      求解 \(f(x)=a^x\mod N\) 的周期
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    <span class="md-ellipsis">
      电路实现
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<div><h1 id="_1">量子计算</h1>
<h2 id="_2">前置</h2>
<h3 id="_3">狄拉克符号</h3>
<p>一般使用<span class="arithmatex">\(\ket{x}\)</span>来表示第<span class="arithmatex">\(x\)</span>位为<span class="arithmatex">\(1\)</span>的，长度为<span class="arithmatex">\(2^n\)</span>的单位向量，<span class="arithmatex">\(n\)</span>是量子比特的位数</p>
<p>具体长成这样：</p>
<div class="arithmatex">\[
\left[\begin{matrix}
0\\
0\\
\vdots\\
1\\
\vdots\\
0\\
\end{matrix}
\right]
\begin{matrix}
(第0位)\\
\\
\vdots\\
(第i位)\\
\vdots\\
(第2^n-1位)\\
\end{matrix}
\]</div>
<p>用<span class="arithmatex">\(\ket\phi= \frac1{\sqrt{2^n}}\sum_{x=0}^{2^n-1}{\ket{x}}\)</span>来表示一个量子叠加态</p>
<h3 id="_4">张量积</h3>
<p>两个向量的张量积等于一个向量中的每个值数乘另一个向量张成的一个大向量</p>
<p><span class="arithmatex">\([1,2]\otimes [3,4]=[1\times 3,1\times 4,2\times 3,2\times 4]=[3,4,6,8]\)</span></p>
<p>注意，如果一个矩阵<span class="arithmatex">\(H\)</span>秩为<span class="arithmatex">\(2\)</span>，那么他的<span class="arithmatex">\(n\)</span>次张量积<span class="arithmatex">\(H^{\otimes n}\)</span>秩为<span class="arithmatex">\(2^n\)</span></p>
<h2 id="_5">相对黑盒</h2>
<h3 id="_6">介绍</h3>
<p>这个问题假设一个<span class="arithmatex">\(n\)</span>位输入的黑盒，其计算函数为<span class="arithmatex">\(f[0,1]^n \to 0,1\)</span></p>
<p>如果对所有<span class="arithmatex">\(x\in[0,2^n-1]\)</span>都有<span class="arithmatex">\(f(x)=0\)</span>或<span class="arithmatex">\(f(x)=1\)</span>，则<span class="arithmatex">\(f(x)\)</span>位常数函数</p>
<p>如果有一半<span class="arithmatex">\(x\)</span>表现为<span class="arithmatex">\(f(x)=0\)</span>,另一半为<span class="arithmatex">\(f(x)=1\)</span>，则<span class="arithmatex">\(f(x)\)</span>为对称函数</p>
<p>我们要判断<span class="arithmatex">\(f(x)\)</span>类型，经典算法需要<span class="arithmatex">\(2^n\)</span>次计算，而量子算法可以做到只需<span class="arithmatex">\(1\)</span>次操作，实现了指数级加速</p>
<h3 id="u_f"><span class="arithmatex">\(U_f\)</span></h3>
<p>这是一个幺正操作，他可以把目标态反转</p>
<p>例如，将<span class="arithmatex">\(\ket{11}\)</span>反转的<span class="arithmatex">\(4\times4\)</span><span class="arithmatex">\(U_f\)</span>算子如下：</p>
<div class="arithmatex">\[
\left[ \begin{matrix}
1 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 1 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 1 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; -1\\
\end{matrix}
\right]
\]</div>
<h3 id="_7">算法</h3>
<p>定义一个初态<span class="arithmatex">\(\ket0^n\)</span></p>
<p>从一个初态开始进行操作</p>
<p>首先将<span class="arithmatex">\(n\)</span>个量子位的Hadamard变换<span class="arithmatex">\(H^{\otimes n}\)</span>作用于初态，得到叠加态
<span class="arithmatex">\(<span class="arithmatex">\(\ket\phi= \frac1{\sqrt{2^n}}\sum_{x=0}^{2^n-1}{\ket{x}}\)</span>\)</span></p>
<p>再将<span class="arithmatex">\(U_f\)</span>作用在叠加态上，得到</p>
<div class="arithmatex">\[
\ket\phi= \frac1{\sqrt{2^n}}\sum_{x=0}^{2^n-1}(-1)^{f(x)}{\ket{x}}\]</div>
<p>由于<span class="arithmatex">\(f(x)\)</span>取值只有<span class="arithmatex">\(0,1\)</span>，所以这个式子表示目标态被反转</p>
<p>再使用<span class="arithmatex">\(H^{\otimes n}\)</span>，得到
$$
\ket\phi= \frac1{\sqrt{2^n}}\sum_{x=0}^{2^n-1}(-1)^{f(x)}\frac1{\sqrt{2^n}}\sum_{y=0}^{2^n-1}(-1)^{x\cdot y}\ket y$$</p>
<p>这里其实是对每个<span class="arithmatex">\(\ket x\)</span>作用<span class="arithmatex">\(H^{\otimes n}\)</span>, 这个<span class="arithmatex">\((-1)^{x\cdot y}\)</span>是由于<span class="arithmatex">\(H^{\otimes n}\)</span>的具体长相为<span class="arithmatex">\(1,-1\)</span>序列导致，读者可以手动模拟一下具体计算过程</p>
<p>此时，测量前<span class="arithmatex">\(n\)</span>个量子位，如果状态为<span class="arithmatex">\(\ket{00\cdots 0}\)</span>则<span class="arithmatex">\(f(x)\)</span>为常数函数，否则为对称函数</p>
<ul>
<li>注：其实矩阵的运算在经典计算机上是<span class="arithmatex">\(O(N^3)\)</span>的，但是量子计算机中的基本门操作可以做到更快, 比如<span class="arithmatex">\(O(1)\)</span>, 具体原理先不讲，也不会</li>
</ul>
<p><em>code:</em></p>
<div class="highlight"><pre><span></span><code><span class="cp">#include</span><span class="cpf">&lt;bits/stdc++.h&gt;</span>
<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">std</span><span class="p">;</span>
<span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">N</span><span class="o">=</span><span class="mi">160</span><span class="p">;</span>
<span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">sqrt2</span><span class="o">=</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">pi</span><span class="o">=</span><span class="n">acos</span><span class="p">(</span><span class="mf">-1.0</span><span class="p">);</span>
<span class="k">typedef</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">db</span><span class="p">;</span>
<span class="kt">int</span><span class="w"> </span><span class="n">T</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">;</span>
<span class="kt">int</span><span class="w"> </span><span class="n">g</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
<span class="n">db</span><span class="w"> </span><span class="n">theta</span><span class="p">,</span><span class="n">delta</span><span class="p">;</span>
<span class="n">mt19937</span><span class="w"> </span><span class="nf">rnd</span><span class="p">(</span><span class="n">time</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">T</span><span class="o">&gt;</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">Matrix</span><span class="p">{</span>
<span class="w">    </span><span class="n">T</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">N</span><span class="p">][</span><span class="n">N</span><span class="p">];</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">;</span>
<span class="w">    </span><span class="n">Matrix</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="o">:</span><span class="n">n</span><span class="p">(</span><span class="n">n</span><span class="p">),</span><span class="n">m</span><span class="p">(</span><span class="n">m</span><span class="p">){</span>
<span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="o">++</span><span class="n">i</span><span class="p">)</span>
<span class="w">            </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">m</span><span class="p">;</span><span class="o">++</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">Matrix</span><span class="p">(){</span>
<span class="w">        </span><span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">m</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span>
<span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="o">++</span><span class="n">i</span><span class="p">)</span>
<span class="w">            </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">m</span><span class="p">;</span><span class="o">++</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">T</span><span class="w"> </span><span class="n">cal</span><span class="p">(){</span>
<span class="w">        </span><span class="n">T</span><span class="w"> </span><span class="n">t</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="o">++</span><span class="n">i</span><span class="p">)</span>
<span class="w">            </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">m</span><span class="p">;</span><span class="o">++</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="n">t</span><span class="o">+=</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">t</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">print_matrix</span><span class="p">(){</span>
<span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="o">++</span><span class="n">i</span><span class="p">){</span>
<span class="w">            </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">m</span><span class="p">;</span><span class="o">++</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">&lt;&lt;</span><span class="s">" "</span><span class="p">;</span>
<span class="w">            </span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">};</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="k">operator</span><span class="w"> </span><span class="o">*</span><span class="p">(</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">B</span><span class="p">){</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="o">=</span><span class="n">A</span><span class="p">.</span><span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="o">=</span><span class="n">A</span><span class="p">.</span><span class="n">m</span><span class="p">,</span><span class="n">p</span><span class="o">=</span><span class="n">B</span><span class="p">.</span><span class="n">m</span><span class="p">;</span>
<span class="w">    </span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">C</span><span class="o">=</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">p</span><span class="p">);</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="o">++</span><span class="n">i</span><span class="p">){</span>
<span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">p</span><span class="p">;</span><span class="o">++</span><span class="n">j</span><span class="p">){</span>
<span class="w">            </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">k</span><span class="o">&lt;</span><span class="n">m</span><span class="p">;</span><span class="o">++</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="n">C</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">+=</span><span class="n">A</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="n">B</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">C</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">typedef</span><span class="w"> </span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">db</span><span class="o">&gt;</span><span class="w"> </span><span class="n">mat</span><span class="p">;</span>
<span class="n">mat</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="n">H</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">tmp</span><span class="p">;</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">cons</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">){</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">n</span><span class="o">==</span><span class="mi">1</span><span class="p">){</span>
<span class="w">        </span><span class="n">H</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">H</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">H</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mf">1.0</span><span class="o">/</span><span class="n">sqrt2</span><span class="p">,</span><span class="n">H</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mf">-1.0</span><span class="o">/</span><span class="n">sqrt2</span><span class="p">;</span>
<span class="w">        </span><span class="k">return</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">cons</span><span class="p">(</span><span class="n">n</span><span class="mi">-1</span><span class="p">);</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">n</span><span class="mi">-1</span><span class="p">));</span><span class="o">++</span><span class="n">i</span><span class="p">){</span>
<span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">n</span><span class="mi">-1</span><span class="p">));</span><span class="o">++</span><span class="n">j</span><span class="p">){</span>
<span class="w">            </span><span class="n">tmp</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">H</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
<span class="w">        </span><span class="p">}</span><span class="w">   </span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">n</span><span class="mi">-1</span><span class="p">));</span><span class="o">++</span><span class="n">i</span><span class="p">){</span>
<span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">n</span><span class="mi">-1</span><span class="p">));</span><span class="n">j</span><span class="o">&lt;</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">n</span><span class="p">);</span><span class="o">++</span><span class="n">j</span><span class="p">){</span>
<span class="w">            </span><span class="n">tmp</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">H</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="p">((</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">n</span><span class="mi">-1</span><span class="p">)))];</span>
<span class="w">        </span><span class="p">}</span><span class="w">   </span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">n</span><span class="mi">-1</span><span class="p">));</span><span class="n">i</span><span class="o">&lt;</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">n</span><span class="p">);</span><span class="o">++</span><span class="n">i</span><span class="p">){</span>
<span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">n</span><span class="mi">-1</span><span class="p">));</span><span class="o">++</span><span class="n">j</span><span class="p">){</span>
<span class="w">            </span><span class="n">tmp</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">H</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">n</span><span class="mi">-1</span><span class="p">))][</span><span class="n">j</span><span class="p">];</span>
<span class="w">        </span><span class="p">}</span><span class="w">   </span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">n</span><span class="mi">-1</span><span class="p">));</span><span class="n">i</span><span class="o">&lt;</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">n</span><span class="p">);</span><span class="o">++</span><span class="n">i</span><span class="p">){</span>
<span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">n</span><span class="mi">-1</span><span class="p">));</span><span class="n">j</span><span class="o">&lt;</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">n</span><span class="p">);</span><span class="o">++</span><span class="n">j</span><span class="p">){</span>
<span class="w">            </span><span class="n">tmp</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=-</span><span class="n">H</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">n</span><span class="mi">-1</span><span class="p">))][</span><span class="n">j</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">n</span><span class="mi">-1</span><span class="p">))];</span>
<span class="w">        </span><span class="p">}</span><span class="w">   </span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">n</span><span class="p">);</span><span class="o">++</span><span class="n">i</span><span class="p">)</span>
<span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">n</span><span class="p">);</span><span class="o">++</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="n">H</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">tmp</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="n">sqrt2</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">init</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="kt">int</span><span class="w"> </span><span class="n">t</span><span class="p">){</span>
<span class="w">    </span><span class="n">a</span><span class="o">=</span><span class="n">mat</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">n</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="w">    </span><span class="n">H</span><span class="o">=</span><span class="n">U</span><span class="o">=</span><span class="n">tmp</span><span class="o">=</span><span class="n">mat</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">n</span><span class="p">,</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">n</span><span class="p">);</span>
<span class="w">    </span><span class="n">a</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">n</span><span class="p">);</span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">U</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">t</span><span class="p">){</span>
<span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">n</span><span class="p">);</span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">g</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">i</span><span class="p">;</span>
<span class="w">        </span><span class="n">shuffle</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">g</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">n</span><span class="p">),</span><span class="n">rnd</span><span class="p">);</span>
<span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">n</span><span class="mi">-1</span><span class="p">);</span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">U</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="n">g</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="n">g</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">=</span><span class="mi">-1</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">cons</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">solve</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">n</span><span class="o">&gt;&gt;</span><span class="n">m</span><span class="p">;</span>
<span class="w">    </span><span class="n">init</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">);</span>
<span class="w">    </span><span class="n">a</span><span class="o">=</span><span class="n">H</span><span class="o">*</span><span class="n">a</span><span class="p">;</span>
<span class="w">    </span><span class="n">a</span><span class="o">=</span><span class="n">U</span><span class="o">*</span><span class="n">a</span><span class="p">;</span>
<span class="w">    </span><span class="n">a</span><span class="o">=</span><span class="n">H</span><span class="o">*</span><span class="n">a</span><span class="p">;</span>
<span class="w">    </span><span class="n">a</span><span class="p">.</span><span class="n">print_matrix</span><span class="p">();</span>
<span class="p">}</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">solve</span><span class="p">();</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>当<span class="arithmatex">\(f(x)=0\)</span>时，程序输出<span class="arithmatex">\(1 0 0 0 0 0 0 0\)</span>, 即<span class="arithmatex">\(\ket {00\cdots 0}\)</span></p>
<p>当<span class="arithmatex">\(f(x)\not =0\)</span>时，则程序不会输出<span class="arithmatex">\(\ket {00\cdots 0}\)</span></p>
<h2 id="grover">Grover</h2>
<p>只需要在黑盒的基础上在添加两步</p>
<p><em>code:</em></p>
<div class="highlight"><pre><span></span><code><span class="cp">#include</span><span class="cpf">&lt;bits/stdc++.h&gt;</span>
<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">std</span><span class="p">;</span>
<span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">N</span><span class="o">=</span><span class="mi">160</span><span class="p">;</span>
<span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">sqrt2</span><span class="o">=</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">pi</span><span class="o">=</span><span class="n">acos</span><span class="p">(</span><span class="mf">-1.0</span><span class="p">);</span>
<span class="k">typedef</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">db</span><span class="p">;</span>
<span class="kt">int</span><span class="w"> </span><span class="n">T</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">;</span>
<span class="c1">//int f[N][N],g[N],a[N],H[N][N],U[N][N],M[N][N],tmp[N+N][N+N];</span>
<span class="kt">int</span><span class="w"> </span><span class="n">g</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
<span class="n">db</span><span class="w"> </span><span class="n">theta</span><span class="p">,</span><span class="n">delta</span><span class="p">;</span>
<span class="n">mt19937</span><span class="w"> </span><span class="nf">rnd</span><span class="p">(</span><span class="n">time</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">T</span><span class="o">&gt;</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">Matrix</span><span class="p">{</span>
<span class="w">    </span><span class="n">T</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">N</span><span class="p">][</span><span class="n">N</span><span class="p">];</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">;</span>
<span class="w">    </span><span class="n">Matrix</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="o">:</span><span class="n">n</span><span class="p">(</span><span class="n">n</span><span class="p">),</span><span class="n">m</span><span class="p">(</span><span class="n">m</span><span class="p">){</span>
<span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="o">++</span><span class="n">i</span><span class="p">)</span>
<span class="w">            </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">m</span><span class="p">;</span><span class="o">++</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">Matrix</span><span class="p">(){</span>
<span class="w">        </span><span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">m</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span>
<span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="o">++</span><span class="n">i</span><span class="p">)</span>
<span class="w">            </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">m</span><span class="p">;</span><span class="o">++</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">T</span><span class="w"> </span><span class="n">cal</span><span class="p">(){</span>
<span class="w">        </span><span class="n">T</span><span class="w"> </span><span class="n">t</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="o">++</span><span class="n">i</span><span class="p">)</span>
<span class="w">            </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">m</span><span class="p">;</span><span class="o">++</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="n">t</span><span class="o">+=</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">t</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">print_matrix</span><span class="p">(){</span>
<span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="o">++</span><span class="n">i</span><span class="p">){</span>
<span class="w">            </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">m</span><span class="p">;</span><span class="o">++</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">&lt;&lt;</span><span class="s">" "</span><span class="p">;</span>
<span class="w">            </span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">};</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="k">operator</span><span class="w"> </span><span class="o">*</span><span class="p">(</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">B</span><span class="p">){</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="o">=</span><span class="n">A</span><span class="p">.</span><span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="o">=</span><span class="n">A</span><span class="p">.</span><span class="n">m</span><span class="p">,</span><span class="n">p</span><span class="o">=</span><span class="n">B</span><span class="p">.</span><span class="n">m</span><span class="p">;</span>
<span class="w">    </span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">C</span><span class="o">=</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">p</span><span class="p">);</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="o">++</span><span class="n">i</span><span class="p">){</span>
<span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">p</span><span class="p">;</span><span class="o">++</span><span class="n">j</span><span class="p">){</span>
<span class="w">            </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">k</span><span class="o">&lt;</span><span class="n">m</span><span class="p">;</span><span class="o">++</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="n">C</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">+=</span><span class="n">A</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="n">B</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">C</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">typedef</span><span class="w"> </span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">db</span><span class="o">&gt;</span><span class="w"> </span><span class="n">mat</span><span class="p">;</span>
<span class="n">mat</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="n">H</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">tmp</span><span class="p">;</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">cons</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">){</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">n</span><span class="o">==</span><span class="mi">1</span><span class="p">){</span>
<span class="w">        </span><span class="n">H</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">H</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">H</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mf">1.0</span><span class="o">/</span><span class="n">sqrt2</span><span class="p">,</span><span class="n">H</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mf">-1.0</span><span class="o">/</span><span class="n">sqrt2</span><span class="p">;</span>
<span class="w">        </span><span class="k">return</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">cons</span><span class="p">(</span><span class="n">n</span><span class="mi">-1</span><span class="p">);</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">n</span><span class="mi">-1</span><span class="p">));</span><span class="o">++</span><span class="n">i</span><span class="p">){</span>
<span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">n</span><span class="mi">-1</span><span class="p">));</span><span class="o">++</span><span class="n">j</span><span class="p">){</span>
<span class="w">            </span><span class="n">tmp</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">H</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
<span class="w">        </span><span class="p">}</span><span class="w">   </span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">n</span><span class="mi">-1</span><span class="p">));</span><span class="o">++</span><span class="n">i</span><span class="p">){</span>
<span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">n</span><span class="mi">-1</span><span class="p">));</span><span class="n">j</span><span class="o">&lt;</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">n</span><span class="p">);</span><span class="o">++</span><span class="n">j</span><span class="p">){</span>
<span class="w">            </span><span class="n">tmp</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">H</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="p">((</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">n</span><span class="mi">-1</span><span class="p">)))];</span>
<span class="w">        </span><span class="p">}</span><span class="w">   </span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">n</span><span class="mi">-1</span><span class="p">));</span><span class="n">i</span><span class="o">&lt;</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">n</span><span class="p">);</span><span class="o">++</span><span class="n">i</span><span class="p">){</span>
<span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">n</span><span class="mi">-1</span><span class="p">));</span><span class="o">++</span><span class="n">j</span><span class="p">){</span>
<span class="w">            </span><span class="n">tmp</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">H</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">n</span><span class="mi">-1</span><span class="p">))][</span><span class="n">j</span><span class="p">];</span>
<span class="w">        </span><span class="p">}</span><span class="w">   </span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">n</span><span class="mi">-1</span><span class="p">));</span><span class="n">i</span><span class="o">&lt;</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">n</span><span class="p">);</span><span class="o">++</span><span class="n">i</span><span class="p">){</span>
<span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">n</span><span class="mi">-1</span><span class="p">));</span><span class="n">j</span><span class="o">&lt;</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">n</span><span class="p">);</span><span class="o">++</span><span class="n">j</span><span class="p">){</span>
<span class="w">            </span><span class="n">tmp</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=-</span><span class="n">H</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">n</span><span class="mi">-1</span><span class="p">))][</span><span class="n">j</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">n</span><span class="mi">-1</span><span class="p">))];</span>
<span class="w">        </span><span class="p">}</span><span class="w">   </span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">n</span><span class="p">);</span><span class="o">++</span><span class="n">i</span><span class="p">)</span>
<span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">n</span><span class="p">);</span><span class="o">++</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="n">H</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">tmp</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="n">sqrt2</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">init</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="p">){</span>
<span class="w">    </span><span class="n">a</span><span class="o">=</span><span class="n">mat</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">n</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="w">    </span><span class="n">H</span><span class="o">=</span><span class="n">U</span><span class="o">=</span><span class="n">M</span><span class="o">=</span><span class="n">tmp</span><span class="o">=</span><span class="n">mat</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">n</span><span class="p">,</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">n</span><span class="p">);</span>
<span class="w">    </span><span class="n">a</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">n</span><span class="p">);</span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">g</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">i</span><span class="p">;</span>
<span class="w">    </span><span class="n">shuffle</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">g</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">n</span><span class="p">),</span><span class="n">rnd</span><span class="p">);</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">n</span><span class="p">);</span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">U</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">M</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">-1</span><span class="p">;</span>
<span class="w">    </span><span class="c1">//U.a[(1&lt;&lt;n)-1][(1&lt;&lt;n)-1]=-1;</span>
<span class="w">    </span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">"we need to find: "</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">m</span><span class="p">;</span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">U</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="n">g</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="n">g</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">=</span><span class="mi">-1</span><span class="p">,</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">g</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&lt;&lt;</span><span class="s">" "</span><span class="p">;</span>
<span class="w">    </span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
<span class="w">    </span><span class="n">M</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="n">cons</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
<span class="p">}</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">Grover</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">t</span><span class="p">){</span>
<span class="w">    </span><span class="n">a</span><span class="o">=</span><span class="n">U</span><span class="o">*</span><span class="n">a</span><span class="p">;</span>
<span class="w">    </span><span class="n">a</span><span class="o">=</span><span class="n">H</span><span class="o">*</span><span class="n">a</span><span class="p">;</span>
<span class="w">    </span><span class="n">a</span><span class="o">=</span><span class="n">M</span><span class="o">*</span><span class="n">a</span><span class="p">;</span>
<span class="w">    </span><span class="n">a</span><span class="o">=</span><span class="n">H</span><span class="o">*</span><span class="n">a</span><span class="p">;</span>
<span class="w">    </span><span class="n">a</span><span class="p">.</span><span class="n">print_matrix</span><span class="p">();</span>
<span class="w">    </span><span class="n">delta</span><span class="o">+=</span><span class="mf">2.0</span><span class="o">*</span><span class="n">theta</span><span class="p">;</span>
<span class="w">    </span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">"!"</span><span class="o">&lt;&lt;</span><span class="n">a</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="n">g</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="s">" "</span><span class="o">&lt;&lt;</span><span class="n">sin</span><span class="p">(</span><span class="n">delta</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">solve</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">n</span><span class="o">&gt;&gt;</span><span class="n">m</span><span class="p">;</span>
<span class="w">    </span><span class="n">init</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">);</span>
<span class="w">    </span><span class="n">a</span><span class="o">=</span><span class="n">H</span><span class="o">*</span><span class="n">a</span><span class="p">;</span>
<span class="w">    </span><span class="n">theta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">asin</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="n">g</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">m</span><span class="p">));</span>
<span class="w">    </span><span class="n">delta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">theta</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">20</span><span class="p">;</span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">Grover</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
<span class="p">}</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">solve</span><span class="p">();</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="shor">Shor</h2>
<h3 id="_8">量子傅里叶变换</h3>
<h4 id="dft">DFT</h4>
<p>经典的傅里叶变换形如：<span class="arithmatex">\(\displaystyle y_k = \frac1{\sqrt{N}} \sum_{j=0}^{N-1}x_j\omega_N^{jk}\)</span></p>
<p>其中 <span class="arithmatex">\(\displaystyle \omega_{N}^{jk} = e^{2\pi i\frac{jk}{N}}\)</span></p>
<h4 id="qft">QFT</h4>
<p>在量子算法中，量子傅里叶变换形如：</p>
<p><span class="arithmatex">\(\displaystyle \ket{j} = \frac1{\sqrt{N}} \sum_{k=0}^{N-1}\omega_N^{jk}\ket{k}\)</span></p>
<p>相对应的酉矩阵为 <span class="arithmatex">\(\displaystyle U_{QFT} = \frac1{\sqrt{N}} \sum_{j=0}^{N-1}\sum_{k=0}^{N-1}\omega_N^{jk}\ket{k}\bra{j}\)</span></p>
<p>具体为 </p>
<p><span class="arithmatex">\(\left[
\begin{array}{c} 1&amp;1 &amp;1&amp;\cdots&amp;1 \\
1 &amp;\omega_N^1 &amp;\omega_N^2 &amp;\cdots &amp; \omega_N^{N-1}\\
1 &amp;\omega_N^2 &amp;\omega_N^4 &amp;\cdots &amp; \omega_N^{2(N-1)}\\
\vdots&amp;\vdots&amp;\vdots&amp;\ddots&amp;\vdots\\
1 &amp;\omega_N^{N-1} &amp;\omega_N^{2(N-1)} &amp;\cdots &amp; \omega_N^{(N-1)(N-1)}\\
\end{array} 
\right]\)</span></p>
<h4 id="qft_1">整理 QFT 得出量子电路易实现的形式</h4>
<p><span class="arithmatex">\(\displaystyle\ket{y}=\frac{1}{\sqrt{N}}\sum_{y=0}^{N-1}\omega_{N}^{xy}\ket{y}\)</span></p>
<p>将 <span class="arithmatex">\(\omega\)</span> 展开，并将 <span class="arithmatex">\(N=2^n\)</span> 代入</p>
<p><span class="arithmatex">\(\displaystyle=\frac{1}{\sqrt{N}}\sum_{y=0}^{N-1}e^{2\pi ixy/2^n}\ket{y}\)</span></p>
<p>将 <span class="arithmatex">\(\displaystyle y/2^n=\sum_{k=1}^n y_k/2^k\)</span> 展开</p>
<p><span class="arithmatex">\(\displaystyle=\frac{1}{\sqrt{N}}\sum_{y=0}^{N-1}e^{2\pi i(\sum_{k=1}^n y_k/2^k)x}\ket{y_1\cdots y_n}\)</span></p>
<p><span class="arithmatex">\(\displaystyle=\frac{1}{\sqrt{N}}\sum_{y=0}^{N-1}\prod_{k=1}^n e^{2\pi ixy_k/2^k}\ket{y_1\cdots y_n}\)</span></p>
<p>这一步将 <span class="arithmatex">\(\displaystyle\sum_{y=0}^{N-1}=\sum_{y_1=0}^1\cdots\sum_{y_n=0}^1\)</span> 展开</p>
<p><span class="arithmatex">\(\displaystyle=\frac{1}{\sqrt{N}}\bigotimes_{k=1}^{n}(\ket 0 + e^{2\pi ix/2^k}\ket{1})\)</span></p>
<p><span class="arithmatex">\(\displaystyle=\frac{1}{\sqrt{N}}(\ket 0 + e^{2\pi ix/2}\ket{1})\otimes(\ket 0 + e^{2\pi ix/2^2}\ket{1})\otimes\cdots\otimes(\ket 0 + e^{2\pi ix/2^n}\ket{1})\)</span></p>
<h4 id="_9">电路实现</h4>
<p>Hadamard 门可以实现 <span class="arithmatex">\(\displaystyle H\ket{x_k}=\frac1{\sqrt2}(\ket0 + \exp(\frac{2\pi i}{2}x_k)\ket1)\)</span> 的功能</p>
<p>除此之外，一个 <span class="arithmatex">\(CROT_k\)</span> 门为 <span class="arithmatex">\(\left[\begin{array}{rcl}I&amp;0\\ 0&amp;UROT_k\end{array}\right]\)</span>, 是可控 <span class="arithmatex">\(UROT_k\)</span> 门</p>
<p>其中 <span class="arithmatex">\(UROT_k=\left[\begin{array}{rcl}1&amp;0\\ 0&amp;\exp(\frac{2\pi i}{2^k})\end{array}\right]\)</span></p>
<p>我们对两个量子比特 <span class="arithmatex">\(\ket{x_ix_j}\)</span> 施加 <span class="arithmatex">\(CROT_k\)</span> 门，有如下效果：</p>
<p><span class="arithmatex">\(CROT_k\ket{0x_j}=\ket{0x_j}\)</span></p>
<p><span class="arithmatex">\(CROT_k\ket{1x_j}=\exp(\frac{2\pi i}{2^k} x_j)\ket{1x_j}\)</span></p>
<p>所以最终的电路为如下：</p>
<p><img alt="alt text" src="../../images/quantum_pic/image.png"></p>
<p>运行电路的具体过程如下：</p>
<p>先施加一个 <span class="arithmatex">\(H\)</span> 门：</p>
<p><span class="arithmatex">\(\displaystyle H\vert x_1x_2\ldots x_n\rangle\)</span></p>
<p><span class="arithmatex">\(\displaystyle=\frac{1}{\sqrt{2}}\left[\vert0\rangle + \exp\left(\frac{2\pi i}{2}x_1\right)\vert1\rangle\right]
\otimes\vert x_2x_3\ldots x_n\rangle\)</span></p>
<p>施加 <span class="arithmatex">\(CROT_2\)</span> 门后得到:</p>
<p>$\displaystyle=
\frac{1}{\sqrt{2}}
\left[\vert0\rangle + \exp\left(\frac{2\pi i}{2^2}x_2 + \frac{2\pi i}{2}x_1\right)\vert1\rangle\right]
\otimes
\vert x_2x_3\ldots x_n\rangle
$</p>
<p>施加所有的 <span class="arithmatex">\(CROT\)</span> 门后得到:</p>
<p><span class="arithmatex">\(\displaystyle=
\frac{1}{\sqrt{2}} 
\left[\vert0\rangle +  
\exp\left( 
    \frac{2\pi i}{2^n}x_n +  
    \frac{2\pi i}{2^{n-1}}x_{n-1} +  
    \ldots +  
    \frac{2\pi i}{2^2}x_2 +  
    \frac{2\pi i}{2}x_1 
    \right) 
    \vert1\rangle\right] 
    \otimes 
    \vert x_2x_3\ldots x_n\rangle\)</span></p>
<p>由于
<span class="arithmatex">\(\displaystyle x = 2^{n-1}x_1 + 2^{n-2}x_2 + \ldots + 2^1x_{n-1} + 2^0x_n\)</span></p>
<p>代入得到</p>
<p><span class="arithmatex">\(\displaystyle\frac{1}{\sqrt{2}} \left[\vert0\rangle + \exp\left(\frac{2\pi i}{2^n}x\right) \vert1\rangle\right] \otimes \vert x_2x_3\ldots x_n\rangle\)</span> </p>
<p>类似地运行完剩余电路，对后 <span class="arithmatex">\(n-1\)</span> 位进行变换，得到：</p>
<p><span class="arithmatex">\(\displaystyle= 
     \frac{1}{\sqrt{2}} 
     \left[\vert0\rangle +  
     \exp\left( 
     \frac{2\pi i}{2^n}x  
     \right) 
     \vert1\rangle\right] 
     \otimes 
     \frac{1}{\sqrt{2}} 
     \left[\vert0\rangle +  
     \exp\left( 
     \frac{2\pi i}{2^{n-1}}x  
     \right) 
     \vert1\rangle\right] 
     \otimes 
     \ldots 
     \otimes 
     \frac{1}{\sqrt{2}} 
     \left[\vert0\rangle +  
     \exp\left( 
     \frac{2\pi i}{2^{2}}x  
     \right) 
     \vert1\rangle\right] 
     \otimes 
     \frac{1}{\sqrt{2}} 
     \left[\vert0\rangle +  
     \exp\left( 
     \frac{2\pi i}{2^{1}}x  
    \right) 
    \vert1\rangle\right]\)</span> </p>
<p>注意到此时得到的状态与上面我们推导出的状态在比特位上相反，所以要交换所有的比特来得到最终状态</p>
<h3 id="_10">模指</h3>
<h4 id="_11">量子加法器</h4>
<p><img alt="alt text" src="../../images/quantum_pic/image-1.png"></p>
<p>上面的 Conditional Phase Shift 模块就是之前的 <span class="arithmatex">\(CROT_k\)</span> 门</p>
<p>那么我们可以如此构造一个电路，注意我们要先做 QFT, 这里的 <span class="arithmatex">\(\phi_i(b)\)</span> 是 QFT 后的第 <span class="arithmatex">\(i\)</span> 位 </p>
<p>这个电路可以记为:</p>
<p><img alt="alt text" src="../../images/quantum_pic/image-2.png"></p>
<p>所以，利用 QFT 和 IQFT， 我们可以得到一个量子加法器：</p>
<p><img alt="alt text" src="../../images/quantum_pic/image-3.png"></p>
<h4 id="_12">量子模加器</h4>
<p>使用上面的量子加法器，可以将 QFT 变换后的状态 <span class="arithmatex">\(\ket{\phi(b)}\)</span> 转化为 <span class="arithmatex">\(\ket{\phi(a+b)\mod N}\)</span></p>
<p>这样我们就可以来构造模加器的电路</p>
<p>具体地，我们先将值 <span class="arithmatex">\(b\)</span> 加上一位 <span class="arithmatex">\(\ket{0}\)</span>, 并整体做 QFT, 得到状态 <span class="arithmatex">\(\phi(b)\)</span>；之后施加一个加法器 <span class="arithmatex">\(\Phi ADD(a)\)</span>，得到状态为 <span class="arithmatex">\(\phi(a+b)\)</span> </p>
<p>注意这个 <span class="arithmatex">\(\phi(a+b)\)</span> 由于我们在做 QFT 前量子位多给了一位，所以不会溢出</p>
<p>之后施加一个反门 <span class="arithmatex">\(\Phi ADD(N)\)</span>，得到状态 <span class="arithmatex">\(\phi(a+b-N)\)</span></p>
<p>如果 <span class="arithmatex">\(a+b\geq N\)</span>, 那么我们得到了想要的状态；</p>
<p>如果 <span class="arithmatex">\(a+b&lt;N\)</span>, 那么我们需要将多减去的 <span class="arithmatex">\(N\)</span> 再加回来</p>
<p>这时我们就可以先施加 IQFT 得到 <span class="arithmatex">\(A+B-N\)</span> ，再将最高位作为控制位输出到最下面的辅助位中，再做 QFT 恢复原本的状态</p>
<p>如果最高位为 <span class="arithmatex">\(1\)</span>, 说明 <span class="arithmatex">\(a+b&lt;N\)</span>, 那么我们就施加一个可控加法器 <span class="arithmatex">\(\Phi ADD(N)\)</span> 得到状态 <span class="arithmatex">\(\phi(a+b)\mod N\)</span></p>
<p>这里可控加法器的构造与使用 <span class="arithmatex">\(UROT_k\)</span> 构造 <span class="arithmatex">\(CROT_k\)</span> 的方法类似</p>
<p>此时还剩下最下面的辅助位没有还原，如果不还原辅助位，那么我们的门操作是不可逆的</p>
<p>所以我们按照前一部分类似的方法，将辅助位还原即可</p>
<p>最终得到了模加器的电路</p>
<p>量子模加器的电路图如下：</p>
<p><img alt="alt text" src="../../images/quantum_pic/image-4.png"></p>
<h4 id="_13">量子可控模乘器</h4>
<p>有了模加器，我们就可以使用 <span class="arithmatex">\(n\)</span> 个模加器构造如下电路：</p>
<p><img alt="alt text" src="../../images/quantum_pic/image-5.png"></p>
<p>这里 <span class="arithmatex">\(\ket c\)</span> 是控制位</p>
<p>如果 <span class="arithmatex">\(c=1\)</span>, 那么所有模加器都收到使能，可以正常运作；同时如果 <span class="arithmatex">\(x_i=1\)</span>, 那么第 <span class="arithmatex">\(i\)</span> 个加法器两位都使能，就会将状态转换为加上 <span class="arithmatex">\(2^ia\)</span> 后的结果</p>
<p>由于 <span class="arithmatex">\(x=x_0+2x_1+\cdots+2^{n-1}x_n\)</span>, 那么每一位 <span class="arithmatex">\(x_i\)</span> 接在模加器 <span class="arithmatex">\(\Phi ADD(2^ia)\mod N\)</span> 的控制位上，如果 <span class="arithmatex">\(x_i=1\)</span>, 就将结果加上 <span class="arithmatex">\(2^ia\)</span> 并对 <span class="arithmatex">\(N\)</span> 取模</p>
<p>最后得到的结果即为 </p>
<p><span class="arithmatex">\(\left\{ \begin{array}{l}\ket{(b+a\cdot x)\mod N}&amp;, c=1\\\\ \ket{b}&amp;, c=0\end{array}\right.\)</span></p>
<h4 id="_14">模指模块</h4>
<p>有了模乘器，我们用两个模乘器和一个交换器即可完成最后的模指模块：</p>
<p><img alt="alt text" src="../../images/quantum_pic/image-6.png"></p>
<p>整个电路运行过程为：</p>
<p><span class="arithmatex">\(\ket x \ket 0 \to\ket x \ket{(a\cdot x)\mod N} \to\ket{(a\cdot x)\mod N} \ket x \to \ket{(a\cdot x)\mod N} \ket {(x-a^{-1}ax)\mod N}=\ket{(a\cdot x)\mod N} \ket 0\)</span></p>
<p>这样在原本的位上得到了模指后的结果，并且将辅助位还原为 <span class="arithmatex">\(0\)</span></p>
<p>对于 <span class="arithmatex">\(U_{a^n}\)</span> 模块，只需要重复 <span class="arithmatex">\(U_a\)</span> 模块 <span class="arithmatex">\(n\)</span> 次即可</p>
<p>对于 <span class="arithmatex">\(U_{a^{2^n}}\)</span>，可以二分构造 <span class="arithmatex">\(U_{a^{2^{n-1}}}\)</span> 模块，然后再合并，可以从合并 <span class="arithmatex">\(O(2^n)\)</span> 次变成合并 <span class="arithmatex">\(O(n)\)</span> 次，从而降低构造的复杂度</p>
<h3 id="qpe">量子相位估计 QPE</h3>
<p>设有一个酉算符 <span class="arithmatex">\(U\)</span> 及其本征态 <span class="arithmatex">\(\ket\psi\)</span>，满足：</p>
<p><span class="arithmatex">\(U\ket \psi = e^{2\pi i\theta}\ket \psi\)</span></p>
<p>其中 <span class="arithmatex">\(\theta\)</span> 是一个未知的实数，称为本征相位（eigenphase）</p>
<p>我们的目的是求出这个 <span class="arithmatex">\(\theta\)</span></p>
<p>首先准备初始态：<span class="arithmatex">\(\ket \phi = \displaystyle\ket 0 ^{\otimes n}\ket \psi\)</span></p>
<p>对于初态作用 <span class="arithmatex">\(H\)</span> 门得到 <span class="arithmatex">\(\displaystyle\ket \phi= \frac1{\sqrt {2^n}}\sum_{k=0}^{2^n-1}\ket k\ket \psi\)</span></p>
<p>依次对工作寄存器中的第 <span class="arithmatex">\(j\)</span> 个比特（从低位到高位）控制地施加 <span class="arithmatex">\(U^{2^j}\)</span> 到数据寄存器上，使系统变为：</p>
<p><span class="arithmatex">\(\displaystyle\ket \phi= \frac1{\sqrt {2^n}}\sum_{k=0}^{2^n-1}\ket kU^k\ket \psi\)</span></p>
<p>由于 <span class="arithmatex">\(U\ket \psi = e^{2\pi i\theta}\ket \psi\)</span>
，代入后得到：</p>
<p><span class="arithmatex">\(\displaystyle\ket \phi= \frac1{\sqrt {2^n}}\sum_{k=0}^{2^n-1}\ket ke^{2\pi i\theta k}\ket \psi\)</span></p>
<p>在工作寄存器上执行逆量子傅里叶变换 IQFT，能够将相位信息 <span class="arithmatex">\(\theta\)</span> 转化为整数表示。</p>
<p>具体地，将 <span class="arithmatex">\(\ket \phi\)</span> 作用 IQFT, 由于 QFT 与 IQFT 表示成：</p>
<p><span class="arithmatex">\(\displaystyle QFT\ket k = \frac1{\sqrt{2^n}}\sum_{j=0}^{2^n-1}e^{2\pi i\frac{kj}{2^n}}\ket j\)</span></p>
<p><span class="arithmatex">\(\displaystyle IQFT\ket j = \frac1{\sqrt{2^n}}\sum_{k=0}^{2^n-1}e^{-2\pi i\frac{kj}{2^n}}\ket k\)</span></p>
<p>那么在前 <span class="arithmatex">\(n\)</span> 位作用 IQFT 后有:</p>
<p><span class="arithmatex">\(\displaystyle IQFT(\frac1{\sqrt {2^n}}\sum_{k=0}^{2^n-1}e^{2\pi i\theta k}\ket k)= \frac1{\sqrt {2^n}}\sum_{k=0}^{2^n-1}e^{2\pi i\theta k}(\frac1{\sqrt{2^n}}\sum_{j=0}^{2^n-1}e^{-2\pi i\frac{kj}{2^n}}\ket j)\)</span></p>
<p><span class="arithmatex">\(\displaystyle=\frac1{ {2^n}}\sum_{k=0}^{2^n-1}\sum_{j=0}^{2^n-1}e^{2\pi i\theta k}(e^{-2\pi i\frac{kj}{2^n}}\ket j) = \frac1{ {2^n}}\sum_{k=0}^{2^n-1}\sum_{j=0}^{2^n-1}e^{2\pi ik(\theta-\frac{j}{2^n})}\ket j\)</span></p>
<p>注意到求和项 <span class="arithmatex">\(\displaystyle S=\sum_{k=0}^{2^n-1}e^{2\pi ik(\theta-\frac{j}{2^n})}\)</span></p>
<p>当 <span class="arithmatex">\(\frac{j}{2^n}=\theta\)</span>, 此时 <span class="arithmatex">\(e^{2\pi ik\cdot 0} =1\)</span>, 则 <span class="arithmatex">\(S=\sum_{k=0}^{2^n-1}1 = 2^n\)</span></p>
<p>当 <span class="arithmatex">\(\frac{j}{2^n}\not=\theta\)</span>, 此时不同的指数项干涉，相位相消，结果为 <span class="arithmatex">\(0\)</span></p>
<p>因此最终状态趋近于 <span class="arithmatex">\(\ket j\)</span>, 我们就可以测量得到 <span class="arithmatex">\(j\)</span>, 再根据这个 <span class="arithmatex">\(j\)</span> 来估计 <span class="arithmatex">\(\theta\)</span></p>
<h3 id="shor_1">Shor 算法</h3>
<h4 id="_15">约化素数因子分解</h4>
<p>素数因子分解问题可以约化为 "求函数 <span class="arithmatex">\(f(x)=a^x\mod N\)</span> 的周期" 问题</p>
<p>具体地，假设一个合数 <span class="arithmatex">\(N=P_1 \cdot P_2\)</span>, 求 <span class="arithmatex">\(P_1, P_2\)</span></p>
<p>现随机取一个整数 <span class="arithmatex">\(y&lt;N\)</span>, 且 <span class="arithmatex">\(\gcd(y,N)=1\)</span></p>
<p>定义阶数 <span class="arithmatex">\(r\)</span> 是使得 <span class="arithmatex">\(y^r=1 \mod N\)</span> 满足的最小正整数</p>
<p>如果 <span class="arithmatex">\(r\)</span> 是奇数，就换一个 <span class="arithmatex">\(y\)</span>;</p>
<p>如果 <span class="arithmatex">\(r\)</span> 是偶数，那么 <span class="arithmatex">\(y^r-1=0\mod N\)</span> 可以变为 <span class="arithmatex">\((y^{r/2}-1)\cdot (y^{r/2}+1) = 0 \mod N\)</span></p>
<p>于是可以设 <span class="arithmatex">\((y^{r/2}-1)\cdot (y^{r/2}+1) = m\cdot N = ts\cdot P_1P_2 = (tP_1) \cdot (sP_2)\)</span></p>
<p>则解为： </p>
<p><span class="arithmatex">\(\left\{ \begin{array}{l}P_1 = \gcd(y^{r/2}-1, N)\\\\ P_2 = \gcd(y^{r/2}+1, N)
\end{array}\right.\)</span></p>
<p>如果这组解是一组平庸解，即</p>
<p><span class="arithmatex">\(\left\{ \begin{array}{l}P_1 = \gcd(y^{r/2}-1, N) = 1\\\\ P_2 = \gcd(y^{r/2}+1, N) = N
\end{array}\right.\)</span></p>
<p>那么就换一个 <span class="arithmatex">\(y\)</span>, 否则就求出了 <span class="arithmatex">\(P_1,P_2\)</span></p>
<p>于是问题转化为求解 <span class="arithmatex">\(f(x)=a^x\mod N\)</span> 的周期</p>
<h4 id="fxaxmod-n">求解 <span class="arithmatex">\(f(x)=a^x\mod N\)</span> 的周期</h4>
<p>有了上面的 QFT 模块和模指模块，我们就可以来构造求 <span class="arithmatex">\(f(x)=a^x\mod N\)</span> 的周期的电路了</p>
<p>具体地，对一个状态 <span class="arithmatex">\(\ket y\)</span> 施加模指电路后得到：</p>
<p><span class="arithmatex">\(\displaystyle U_a\ket y=\ket{ay\mod N}\)</span></p>
<p>注意到 <span class="arithmatex">\(U_a\)</span> 可以视为一个量子门，即对应着一个矩阵</p>
<p>我们想要知道这个矩阵的特征值</p>
<p>举一个 <span class="arithmatex">\(a=7,N=15\)</span> 的例子：</p>
<p><span class="arithmatex">\(\displaystyle U_a\ket1 = \ket 7\)</span></p>
<p><span class="arithmatex">\(\displaystyle U_a^2\ket1 = U_{a^2}= \ket 4\)</span></p>
<p><span class="arithmatex">\(\displaystyle U_a^3\ket1 = U_{a^3}= \ket {13}\)</span></p>
<p><span class="arithmatex">\(\displaystyle U_a^4\ket1 = U_{a^4}= \ket 1\)</span></p>
<p>可以看到 <span class="arithmatex">\(f(x)=a^x\mod N\)</span> 的阶数 <span class="arithmatex">\(r=4\)</span>, 而状态也在 <span class="arithmatex">\(4\)</span> 次变换后回到 <span class="arithmatex">\(\ket 1\)</span></p>
<p>所以构造一个状态 <span class="arithmatex">\(\ket {u_0}=\frac1{\sqrt r}\sum_{k=0}^{r-1}\ket{a^k\mod N}\)</span></p>
<p>则 <span class="arithmatex">\(U_a\ket {u_0}=\frac1{\sqrt r}\sum_{k=0}^{r-1}U_a\ket{a^k\mod N} = \frac1{\sqrt r}\sum_{k=0}^{r-1}\ket{a^{k+1}\mod N} = \ket {u_0}\)</span></p>
<p>所以 <span class="arithmatex">\(\ket{u_0}\)</span> 是矩阵的一个特征向量，对应的一个特征值为 <span class="arithmatex">\(1\)</span></p>
<p>进一步，我们构造 <span class="arithmatex">\(\ket {u_s} = \frac1{\sqrt r}\sum_{k=0}^{r-1}e^{-\frac{2\pi isk}r}\ket{a^k\mod N}\)</span>, 可以得到 <span class="arithmatex">\(U_a\ket {u_s} = e^{\frac{2\pi is}r}\ket {u_s}\)</span></p>
<p>这些特征值/特征向量十分特殊，因为他们包含了我们要求的周期：<span class="arithmatex">\(r\)</span></p>
<p>这时我们将所有 <span class="arithmatex">\(\ket {u_s}\)</span> 相加，可以使得除了 <span class="arithmatex">\(\ket1\)</span> 的所有状态的相位抵消, 即 <span class="arithmatex">\(\frac1{\sqrt r}\sum_{s=0}^{r-1}\ket{u_s}=\ket 1\)</span></p>
<p>具体地，对于 <span class="arithmatex">\(a=7,N=15,r=4\)</span>:</p>
<p><span class="arithmatex">\(|u_0\rangle = \tfrac{1}{2}(|1\rangle \hphantom{e^{-\tfrac{2\pi i}{12}}}+ |7\rangle \hphantom{e^{-\tfrac{12\pi i}{12}}} + |4\rangle \hphantom{e^{-\tfrac{12\pi i}{12}}} + |13\rangle)\)</span></p>
<p><span class="arithmatex">\(|u_1\rangle = \tfrac{1}{2}(|1\rangle + e^{-\tfrac{2\pi i}{4}}|7\rangle + e^{-\tfrac{\hphantom{1}4\pi i}{4}}|4\rangle + e^{-\tfrac{\hphantom{1}6\pi i}{4}}|13\rangle)\)</span></p>
<p><span class="arithmatex">\(|u_2\rangle = \tfrac{1}{2}(|1\rangle + e^{-\tfrac{4\pi i}{4}}|7\rangle + e^{-\tfrac{\hphantom{1}8\pi i}{4}}|4\rangle + e^{-\tfrac{12\pi i}{4}}|13\rangle)\)</span></p>
<p><span class="arithmatex">\(|u_3\rangle = \tfrac{1}{2}(|1\rangle + e^{-\tfrac{6\pi i}{4}}|7\rangle + e^{-\tfrac{12\pi i}{4}}|4\rangle + e^{-\tfrac{18\pi i}{4}}|13\rangle)\)</span></p>
<p><span class="arithmatex">\(\therefore \frac12(\ket{u_0} + \ket{u_1} + \ket{u_2} + \ket{u_3} )= |1\rangle\)</span></p>
<p>由于 <span class="arithmatex">\(\ket1\)</span> 是这些特征向量的叠加态，所以，如果我们将 <span class="arithmatex">\(\ket1\)</span> 作为 <span class="arithmatex">\(\ket \psi\)</span> 做 QPE (量子相位估计)， 那么我们会得到一个相位估计值：</p>
<p><span class="arithmatex">\(\displaystyle\phi = \frac sr\)</span></p>
<p>其中 <span class="arithmatex">\(s\in[0,r-1]\)</span> 是一个随机值</p>
<p>这样，我们对 <span class="arithmatex">\(\phi\)</span> 做连分数即可估计出 <span class="arithmatex">\(s\)</span> 和 <span class="arithmatex">\(r\)</span></p>
<p>如果 <span class="arithmatex">\(\gcd(s,r)=1\)</span>, 那么我们就得出了最终结果 <span class="arithmatex">\(r\)</span>;</p>
<p>否则，结果为 <span class="arithmatex">\(\frac r{\gcd(s,r)}\)</span>, 不是我们想要的结果</p>
<p>但是，根据数论的一些定理，结果正确的概率为 <span class="arithmatex">\(\frac1{\log\log r}\)</span>, 所以期望在 <span class="arithmatex">\(O(\log\log r)\)</span> 步得出正确的 <span class="arithmatex">\(r\)</span></p>
<p>至此，Shor 算法的主要流程便介绍完毕了</p>
<h3 id="_16">电路实现</h3>
<p>为了保证精确度，我们可以使用 <span class="arithmatex">\(2n\)</span> 个量子比特来做 QFT 和 QPE，<span class="arithmatex">\(n\)</span> 个量子比特来做模指</p>
<p>具体地，先作用 <span class="arithmatex">\(H\)</span> 门，得到初态 <span class="arithmatex">\(\displaystyle\ket\phi = \frac1{\sqrt {2^{2n}}}\sum_{x=0}^{ {2^{2n}}-1}\ket x \ket 1\)</span></p>
<p>然后将 <span class="arithmatex">\(2n\)</span> 个模指模块的控制位接到 <span class="arithmatex">\(2n\)</span> 个量子位，经过这一步原先状态变为 <span class="arithmatex">\(\displaystyle\ket\phi = \frac1{\sqrt {2^{2n}}}\sum_{x=0}^{ {2^{2n}}-1}\ket x\ket{f(x)}\)</span></p>
<p>这里 <span class="arithmatex">\(\ket{f(x)}=\ket{a^x\mod N}=U_a^x\ket1\)</span></p>
<p>由于 <span class="arithmatex">\(\ket 1 = \frac1{\sqrt r}\sum_{s=0}^{r-1}\ket{u_s}\)</span>, 并且 <span class="arithmatex">\(U_a\ket {u_s} = e^{\frac{2\pi is}r}\ket {u_s}\)</span></p>
<p>所以原状态可以展开为：</p>
<p><span class="arithmatex">\(\displaystyle\ket\phi = \frac1{\sqrt {2^{2n}}}\sum_{x=0}^{ {2^{2n}}-1}\ket x\frac1{\sqrt r}\sum_{s=0}^{r-1}U_a^x\ket{u_s}\)</span></p>
<p><span class="arithmatex">\(\displaystyle= \frac1{\sqrt {2^{2n}}}\frac1{\sqrt r}\sum_{x=0}^{ {2^{2n}}-1}\sum_{s=0}^{r-1}e^{\frac{2\pi is}r\cdot x}\ket x\ket{u_s}\)</span></p>
<p>那么在前 <span class="arithmatex">\(2n\)</span> 位作用 IQFT 后有:</p>
<p><span class="arithmatex">\(\displaystyle IQFT(\ket \phi)= \frac1{\sqrt {2^{2n}}}\frac1{\sqrt r}\sum_{x=0}^{ {2^{2n}}-1}(\frac1{\sqrt {2^{2n}}}\sum_{j=0}^{2^{2n}-1}e^{-2\pi i\frac{xj}{2^{2n}}}\ket j)\sum_{s=0}^{r-1}e^{\frac{2\pi is}r\cdot x}\)</span></p>
<p><span class="arithmatex">\(\displaystyle=\frac1{ {2^{2n}}}\frac1{\sqrt r}\sum_{x=0}^{ {2^{2n}}-1}\sum_{j=0}^{2^{2n}-1}\sum_{s=0}^{r-1}(e^{\frac{2\pi is}r\cdot x}\cdot e^{-2\pi i\frac{xj}{2^{2n}}}\ket j)\)</span></p>
<p><span class="arithmatex">\(\displaystyle=\frac1{ {2^{2n}}}\frac1{\sqrt r}\sum_{x=0}^{ {2^{2n}}-1}\sum_{j=0}^{2^{2n}-1}\sum_{s=0}^{r-1}(e^{2\pi ix(\frac{s}{r}-\frac{j}{2^{2n}})}\ket j)\)</span></p>
<p>注意到求和项 <span class="arithmatex">\(\displaystyle S=\sum_{x=0}^{ {2^{2n}}-1}e^{2\pi ix(\frac{s}{r}-\frac{j}{2^{2n}})}\)</span></p>
<p>当 <span class="arithmatex">\(\frac{j}{2^{2n}}=\frac{s}{r}\)</span>, 此时 <span class="arithmatex">\(e^{2\pi ix\cdot 0} =1\)</span>, 则 <span class="arithmatex">\(S= 2^{2n}\)</span></p>
<p>当 <span class="arithmatex">\(\frac{j}{2^{2n}}\not=\frac{s}{r}\)</span>, 此时不同的指数项干涉，相位相消，结果为 <span class="arithmatex">\(0\)</span></p>
<p>所以最终表达式为 <span class="arithmatex">\(\displaystyle\ket \phi=\frac1{\sqrt r}\sum_{j=0}^{2^{2n}-1}\sum_{s=0}^{r-1}\delta_{\frac sr, \frac j{2^{2n}}}\ket j = \frac1{\sqrt r}\sum_{\frac sr = \frac j{2^{2n}}}\ket j\)</span></p>
<p>这说明最终的状态趋近于 <span class="arithmatex">\(r\)</span> 个 <span class="arithmatex">\(\ket j\)</span> 叠加，我们只需要测量就可以以 <span class="arithmatex">\(\frac1r\)</span> 的等概率得到任意一个 <span class="arithmatex">\(j\)</span>, 进而可以得到 <span class="arithmatex">\(\theta = \frac sr\)</span></p>
<p>最终的线路图如下：</p>
<p><img alt="alt text" src="../../images/quantum_pic/image-7.png"></p></div>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2025 - 2077 AKonjac_
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.60a45f97.min.js"></script>
      
        <script src="../../javascripts/katex.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/katex.min.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/contrib/auto-render.min.js"></script>
      
    
  </body>
</html>