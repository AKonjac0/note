<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../../img/favicon.ico">
        <title>欧几里得&amp;扩展欧几里得 - My Docs</title>
        <link href="../../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../../css/fontawesome.min.css" rel="stylesheet">
        <link href="../../../css/brands.min.css" rel="stylesheet">
        <link href="../../../css/solid.min.css" rel="stylesheet">
        <link href="../../../css/v4-font-face.min.css" rel="stylesheet">
        <link href="../../../css/base.css" rel="stylesheet">
        <link id="hljs-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" >
        <link id="hljs-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css" disabled>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../../..">My Docs</a>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">

                    <ul class="nav navbar-nav ms-md-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-toggle="modal" data-bs-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-body-tertiary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-bs-level="1"><a href="#_1" class="nav-link">欧几里得&amp;扩展欧几里得</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-bs-level="2"><a href="#_2" class="nav-link">朴素欧几里得</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#_3" class="nav-link">扩展欧几里得</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="_1">欧几里得&amp;扩展欧几里得</h1>
<h2 id="_2">朴素欧几里得</h2>
<p>就是辗转相除法。$\gcd(a,b)=\gcd(b,a\mod b)$</p>
<pre><code class="language-cpp">int gcd(int a, int b) {
    return !b ? a : gcd(b, a % b);
}
</code></pre>
<p>复杂度$O(\log n)$</p>
<h2 id="_3">扩展欧几里得</h2>
<p>扩展欧几里得主要用来求解：</p>
<p>$ax+by=\gcd(a,b)$的特殊解。</p>
<p>可以用它求解这样的模线性方程：</p>
<p>$ax \equiv b\pmod n$</p>
<p>其实就是求$ax+ny=b$的解。</p>
<p>而这个方程有解的前提是$b \mod \gcd(a,n)=0$,即$b$是$\gcd(a,n)$的倍数。这样才能转化为求$ax+ny=\gcd(a,n)$的一组解，在推到$ax+ny=b$上。</p>
<p>模板：</p>
<pre><code class="language-cpp">void exgcd(int a,int b,int &amp;d,int &amp;x,int &amp;y){
    if(!b)d=a,x=1,y=0;
    else exgcd(b,a%b,d,y,x),y-=a/b*x;
}
</code></pre>
<p>这个递归的原理是：</p>
<p>假设当前$ax+by=\gcd(b,a\mod b)$有一组解$(x_1,y_1)$,则有：</p>
<p>$$\gcd(a,b)=\gcd(b,a \mod b)\
ax+by=bx_1+(a-\lfloor\frac ab\rfloor b)y_1\
ax+by=a(y_1)+b(x_1-\lfloor\frac ab\rfloor y_1)
$$</p>
<p>因此$x=y_1,y=x_1-\lfloor\frac ab\rfloor y_1$,这样迭代即可得出一组特殊解。</p>
<p>特别地，当$b=0$时，$x=1,y=0$.</p>
<p>有了这组解，那么对于任意$c$满足$ax+by=c,c \mod \gcd(a,b)=0$的一组特殊解为$(\frac{x_0c}{\gcd(a,b)},\frac{y_0c}{\gcd(a,b)})$  <strong>(1)</strong></p>
<p>那如果我想求任意一组可行解呢?</p>
<p>假设$a'=a/ \gcd(a,b) ,b'=b/ \gcd(a,b)$</p>
<p>那么对于一组$ax+by=c$的解$(x_1,y_1)$,有任意整数解$(x_1+kb',y_1-ka')$<strong>(2)</strong></p>
<p>这是因为对于任意一组解$(x_2,y_2)$,有：</p>
<p>$$
ax_1+by_1=ax_2+by_2\
a(x_1-x_2)=b(y_2-y_1)\
设\gcd(a,b)=g,则\
a'(x_1-x_2)=b'(y_2-y_1)\
\because a'与b'互质\
\therefore x_1-x_2=kb'\
y_2-y_1=ka'
$$</p>
<p>如果要求求出指定的解(如最小非负整数解)，根据要求向$x_0$加减$b$即可。</p>
<p>注意 <strong>(1)</strong> 和 <strong>(2)</strong> 顺序不能倒，因为先2后1相当于将$b' \to \frac{b'c}{g}$,就不满足2的性质了。</p>
<p>复杂度同样为$O(\log n)$</p>
<blockquote>
<p>P1082</p>
</blockquote>
<p>模板题。</p>
<pre><code class="language-cpp">#include&lt;iostream&gt;
#include&lt;cstdio&gt;
#include&lt;cstring&gt;
#define int long long 
using namespace std;
void exgcd(int a,int b,int &amp;d,int &amp;x,int &amp;y){
    if(!b)d=a,x=1,y=0;
    else exgcd(b,a%b,d,y,x),y-=a/b*x;
}
int a,b,gcd,x,y;
signed main(){
    scanf(&quot;%lld%lld&quot;,&amp;a,&amp;b);
    exgcd(a,b,gcd,x,y);
    x=(x%b+b)%b;//注意，这里不用推导b'时因为题目规定gcd(a,b)=1,不是没有必要。
    printf(&quot;%lld&quot;,x);
    return 0;
} 
</code></pre>
<blockquote>
<p>P1516</p>
</blockquote>
<p>化简题意后，我们知道原题要求的是一个最小非负整数解$i$，满足：</p>
<p>$$x+mi\equiv y+ni\pmod L\
(m-n)i\equiv y-x\pmod L\
设a=m-n,b=L,c=y-x,则\
ai+bj=c
$$</p>
<p>到此，原题变为扩欧模板题。</p>
<pre><code class="language-cpp">#include&lt;iostream&gt;
#include&lt;cstdio&gt;
#include&lt;cstring&gt;
#define int long long 
using namespace std;
void exgcd(int a,int b,int &amp;d,int &amp;x,int &amp;y){
    if(!b)d=a,x=1,y=0;
    else exgcd(b,a%b,d,y,x),y-=a/b*x;
}
int x,y,n,m,L,a,b,c,g,i,j,_b,_a;
signed main(){
    scanf(&quot;%lld%lld%lld%lld%lld&quot;,&amp;x,&amp;y,&amp;m,&amp;n,&amp;L);
    a=m-n,c=y-x,b=L;
    if(a&lt;0 &amp;&amp; b&gt;0){
        while(a&lt;0)a+=b;
    }else if(a&gt;0 &amp;&amp; b&lt;0){
        while(b&lt;0)b+=a;
    }else if(a&lt;0 &amp;&amp; b&lt;0)a=-a,b=-b;//注意这里的负数处理方式。

    exgcd(a,b,g,i,j);
    _a=a/g,_b=b/g;
    if(c%g!=0){
        printf(&quot;Impossible&quot;);
        return 0;
    }
    i=(c/g)*i;
    i=(i%_b+_b)%_b;
    printf(&quot;%lld&quot;,i);
    return 0;
}
</code></pre></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../../../js/bootstrap.bundle.min.js"></script>
        <script>
            var base_url = "../../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../../js/base.js"></script>
        <script src="../../../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
